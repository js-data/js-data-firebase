{"version":3,"file":"js-data-firebase.js","sources":["../../../../../../\u0000babelHelpers","../node_modules/js-data-adapter/src/index.js","../src/index.js"],"sourcesContent":["var babelHelpers = {};\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nexport var jsx = function () {\n  var REACT_ELEMENT_TYPE = typeof Symbol === \"function\" && Symbol.for && Symbol.for(\"react.element\") || 0xeac7;\n  return function createRawReactElement(type, props, key, children) {\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {};\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  };\n}();\n\nexport var asyncIterator = function (iterable) {\n  if (typeof Symbol === \"function\") {\n    if (Symbol.asyncIterator) {\n      var method = iterable[Symbol.asyncIterator];\n      if (method != null) return method.call(iterable);\n    }\n\n    if (Symbol.iterator) {\n      return iterable[Symbol.iterator]();\n    }\n  }\n\n  throw new TypeError(\"Object is not async iterable\");\n};\n\nexport var asyncGenerator = function () {\n  function AwaitValue(value) {\n    this.value = value;\n  }\n\n  function AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n\n        if (value instanceof AwaitValue) {\n          Promise.resolve(value.value).then(function (arg) {\n            resume(\"next\", arg);\n          }, function (arg) {\n            resume(\"throw\", arg);\n          });\n        } else {\n          settle(result.done ? \"return\" : \"normal\", result.value);\n        }\n      } catch (err) {\n        settle(\"throw\", err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case \"return\":\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case \"throw\":\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== \"function\") {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === \"function\" && Symbol.asyncIterator) {\n    AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke(\"next\", arg);\n  };\n\n  AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke(\"throw\", arg);\n  };\n\n  AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke(\"return\", arg);\n  };\n\n  return {\n    wrap: function (fn) {\n      return function () {\n        return new AsyncGenerator(fn.apply(this, arguments));\n      };\n    },\n    await: function (value) {\n      return new AwaitValue(value);\n    }\n  };\n}();\n\nexport var asyncGeneratorDelegate = function (inner, awaitWrap) {\n  var iter = {},\n      waiting = false;\n\n  function pump(key, value) {\n    waiting = true;\n    value = new Promise(function (resolve) {\n      resolve(inner[key](value));\n    });\n    return {\n      done: false,\n      value: awaitWrap(value)\n    };\n  }\n\n  ;\n\n  if (typeof Symbol === \"function\" && Symbol.iterator) {\n    iter[Symbol.iterator] = function () {\n      return this;\n    };\n  }\n\n  iter.next = function (value) {\n    if (waiting) {\n      waiting = false;\n      return value;\n    }\n\n    return pump(\"next\", value);\n  };\n\n  if (typeof inner.throw === \"function\") {\n    iter.throw = function (value) {\n      if (waiting) {\n        waiting = false;\n        throw value;\n      }\n\n      return pump(\"throw\", value);\n    };\n  }\n\n  if (typeof inner.return === \"function\") {\n    iter.return = function (value) {\n      return pump(\"return\", value);\n    };\n  }\n\n  return iter;\n};\n\nexport var asyncToGenerator = function (fn) {\n  return function () {\n    var gen = fn.apply(this, arguments);\n    return new Promise(function (resolve, reject) {\n      function step(key, arg) {\n        try {\n          var info = gen[key](arg);\n          var value = info.value;\n        } catch (error) {\n          reject(error);\n          return;\n        }\n\n        if (info.done) {\n          resolve(value);\n        } else {\n          return Promise.resolve(value).then(function (value) {\n            step(\"next\", value);\n          }, function (err) {\n            step(\"throw\", err);\n          });\n        }\n      }\n\n      return step(\"next\");\n    });\n  };\n};\n\nexport var classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nexport var createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nexport var defineEnumerableProperties = function (obj, descs) {\n  for (var key in descs) {\n    var desc = descs[key];\n    desc.configurable = desc.enumerable = true;\n    if (\"value\" in desc) desc.writable = true;\n    Object.defineProperty(obj, key, desc);\n  }\n\n  return obj;\n};\n\nexport var defaults = function (obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n};\n\nexport var defineProperty = function (obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n};\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nexport var get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nexport var inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nvar _instanceof = function (left, right) {\n  if (right != null && typeof Symbol !== \"undefined\" && right[Symbol.hasInstance]) {\n    return right[Symbol.hasInstance](left);\n  } else {\n    return left instanceof right;\n  }\n};\n\nexport var interopRequireDefault = function (obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n};\n\nexport var interopRequireWildcard = function (obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n};\n\nexport var newArrowCheck = function (innerThis, boundThis) {\n  if (innerThis !== boundThis) {\n    throw new TypeError(\"Cannot instantiate an arrow function\");\n  }\n};\n\nexport var objectDestructuringEmpty = function (obj) {\n  if (obj == null) throw new TypeError(\"Cannot destructure undefined\");\n};\n\nexport var objectWithoutProperties = function (obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n};\n\nexport var possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\nexport var selfGlobal = typeof global === \"undefined\" ? self : global;\n\nexport var set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\nexport var slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nexport var slicedToArrayLoose = function (arr, i) {\n  if (Array.isArray(arr)) {\n    return arr;\n  } else if (Symbol.iterator in Object(arr)) {\n    var _arr = [];\n\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  } else {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n  }\n};\n\nexport var taggedTemplateLiteral = function (strings, raw) {\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n};\n\nexport var taggedTemplateLiteralLoose = function (strings, raw) {\n  strings.raw = raw;\n  return strings;\n};\n\nexport var temporalRef = function (val, name, undef) {\n  if (val === undef) {\n    throw new ReferenceError(name + \" is not defined - temporal dead zone\");\n  } else {\n    return val;\n  }\n};\n\nexport var temporalUndefined = {};\n\nexport var toArray = function (arr) {\n  return Array.isArray(arr) ? arr : Array.from(arr);\n};\n\nexport var toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nbabelHelpers;\n\nexport { _typeof as typeof, _extends as extends, _instanceof as instanceof }","import { Component, utils } from 'js-data'\n\nexport const noop = function (...args) {\n  const opts = args[args.length - 1]\n  this.dbg(opts.op, ...args)\n  return utils.resolve()\n}\n\nexport const noop2 = function (...args) {\n  const opts = args[args.length - 2]\n  this.dbg(opts.op, ...args)\n  return utils.resolve()\n}\n\nexport const unique = function (array) {\n  const seen = {}\n  const final = []\n  array.forEach(function (item) {\n    if (item in seen) {\n      return\n    }\n    final.push(item)\n    seen[item] = 0\n  })\n  return final\n}\n\nexport const withoutRelations = function (mapper, props, opts) {\n  opts || (opts = {})\n  opts.with || (opts.with = [])\n  const relationFields = mapper.relationFields || []\n  const toStrip = relationFields.filter((value) => opts.with.indexOf(value) === -1)\n  return utils.omit(props, toStrip)\n}\n\nexport const reserved = [\n  'orderBy',\n  'sort',\n  'limit',\n  'offset',\n  'skip',\n  'where'\n]\n\n/**\n * Response object used when `raw` is `true`. May contain other fields in\n * addition to `data`.\n *\n * @class Response\n */\nexport function Response (data, meta, op) {\n  meta || (meta = {})\n\n  /**\n   * Response data.\n   *\n   * @name Response#data\n   * @type {*}\n   */\n  this.data = data\n\n  utils.fillIn(this, meta)\n\n  /**\n   * The operation for which the response was created.\n   *\n   * @name Response#op\n   * @type {string}\n   */\n  this.op = op\n}\n\nconst DEFAULTS = {\n  /**\n   * Whether to log debugging information.\n   *\n   * @name Adapter#debug\n   * @type {boolean}\n   * @default false\n   */\n  debug: false,\n\n  /**\n   * Whether to return a more detailed response object.\n   *\n   * @name Adapter#raw\n   * @type {boolean}\n   * @default false\n   */\n  raw: false\n}\n\n/**\n * Abstract class meant to be extended by adapters.\n *\n * @class Adapter\n * @abstract\n * @extends Component\n * @param {Object} [opts] Configuration opts.\n * @param {boolean} [opts.debug=false] Whether to log debugging information.\n * @param {boolean} [opts.raw=false] Whether to return a more detailed response\n * object.\n */\nexport function Adapter (opts) {\n  utils.classCallCheck(this, Adapter)\n  Component.call(this, opts)\n  opts || (opts = {})\n  utils.fillIn(opts, DEFAULTS)\n  utils.fillIn(this, opts)\n}\n\nComponent.extend({\n  constructor: Adapter,\n\n  /**\n   * Lifecycle method method called by <a href=\"#count__anchor\">count</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#count__anchor\">count</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the count.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#count__anchor\">count</a>.\n   *\n   * @name Adapter#afterCount\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @property {string} opts.op `afterCount`\n   * @param {Object|Response} response Count or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterCount: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#create__anchor\">create</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#create__anchor\">create</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the created record.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#create__anchor\">create</a>.\n   *\n   * @name Adapter#afterCreate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @property {string} opts.op `afterCreate`\n   * @param {Object|Response} response Created record or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterCreate: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#createMany__anchor\">createMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the created records.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * @name Adapter#afterCreate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object[]} props The `props` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @property {string} opts.op `afterCreateMany`\n   * @param {Object[]|Response} response Created records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterCreateMany: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroy__anchor\">destroy</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be `undefined`.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * @name Adapter#afterDestroy\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @property {string} opts.op `afterDestroy`\n   * @param {undefined|Response} response `undefined` or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterDestroy: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroyAll__anchor\">destroyAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be `undefined`.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * @name Adapter#afterDestroyAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @property {string} opts.op `afterDestroyAll`\n   * @param {undefined|Response} response `undefined` or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterDestroyAll: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#find__anchor\">find</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#find__anchor\">find</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the found record, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#find__anchor\">find</a>.\n   *\n   * @name Adapter#afterFind\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @property {string} opts.op `afterFind`\n   * @param {Object|Response} response The found record or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterFind: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#findAll__anchor\">findAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the found records, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * @name Adapter#afterFindAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @property {string} opts.op `afterFindAll`\n   * @param {Object[]|Response} response The found records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterFindAll: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#sum__anchor\">sum</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the sum.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * @name Adapter#afterSum\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {string} field The `field` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @property {string} opts.op `afterSum`\n   * @param {Object|Response} response Count or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterSum: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#update__anchor\">update</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#update__anchor\">update</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated record.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#update__anchor\">update</a>.\n   *\n   * @name Adapter#afterUpdate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @property {string} opts.op `afterUpdate`\n   * @param {Object|Response} response The updated record or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterUpdate: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateAll__anchor\">updateAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated records, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * @name Adapter#afterUpdateAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @property {string} opts.op `afterUpdateAll`\n   * @param {Object[]|Response} response The updated records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterUpdateAll: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateMany__anchor\">updateMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated records, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * @name Adapter#afterUpdateMany\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object[]} records The `records` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @property {string} opts.op `afterUpdateMany`\n   * @param {Object[]|Response} response The updated records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterUpdateMany: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#count__anchor\">count</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#count__anchor\">count</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#count__anchor\">count</a>.\n   *\n   * @name Adapter#beforeCount\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @property {string} opts.op `beforeCount`\n   */\n  beforeCount: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#create__anchor\">create</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#create__anchor\">create</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#create__anchor\">create</a>.\n   *\n   * @name Adapter#beforeCreate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @property {string} opts.op `beforeCreate`\n   */\n  beforeCreate: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#createMany__anchor\">createMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * @name Adapter#beforeCreateMany\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object[]} props The `props` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @property {string} opts.op `beforeCreateMany`\n   */\n  beforeCreateMany: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroy__anchor\">destroy</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * @name Adapter#beforeDestroy\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @property {string} opts.op `beforeDestroy`\n   */\n  beforeDestroy: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroyAll__anchor\">destroyAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * @name Adapter#beforeDestroyAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @property {string} opts.op `beforeDestroyAll`\n   */\n  beforeDestroyAll: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#find__anchor\">find</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#find__anchor\">find</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#find__anchor\">find</a>.\n   *\n   * @name Adapter#beforeFind\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @property {string} opts.op `beforeFind`\n   */\n  beforeFind: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#findAll__anchor\">findAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * @name Adapter#beforeFindAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @property {string} opts.op `beforeFindAll`\n   */\n  beforeFindAll: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#sum__anchor\">sum</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * @name Adapter#beforeSum\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @property {string} opts.op `beforeSum`\n   */\n  beforeSum: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#update__anchor\">update</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#update__anchor\">update</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#update__anchor\">update</a>.\n   *\n   * @name Adapter#beforeUpdate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @property {string} opts.op `beforeUpdate`\n   */\n  beforeUpdate: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateAll__anchor\">updateAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * @name Adapter#beforeUpdateAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @property {string} opts.op `beforeUpdateAll`\n   */\n  beforeUpdateAll: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateMany__anchor\">updateMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * @name Adapter#beforeUpdateMany\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object[]} props The `props` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @property {string} opts.op `beforeUpdateMany`\n   */\n  beforeUpdateMany: noop,\n\n  /**\n   * Retrieve the number of records that match the selection query. Called by\n   * `Mapper#count`.\n   *\n   * @name Adapter#count\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  count (mapper, query, opts) {\n    let op\n    query || (query = {})\n    opts || (opts = {})\n\n    // beforeCount lifecycle hook\n    op = opts.op = 'beforeCount'\n    return utils.resolve(this[op](mapper, query, opts))\n      .then(() => {\n        // Allow for re-assignment from lifecycle hook\n        op = opts.op = 'count'\n        this.dbg(op, mapper, query, opts)\n        return utils.resolve(this._count(mapper, query, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        result || (result = {})\n        let response = new Response(data, result, op)\n        response = this.respond(response, opts)\n\n        // afterCount lifecycle hook\n        op = opts.op = 'afterCount'\n        return utils.resolve(this[op](mapper, query, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Create a new record. Called by `Mapper#create`.\n   *\n   * @name Adapter#create\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The record to be created.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  create (mapper, props, opts) {\n    let op\n    props || (props = {})\n    opts || (opts = {})\n\n    // beforeCreate lifecycle hook\n    op = opts.op = 'beforeCreate'\n    return utils.resolve(this[op](mapper, props, opts))\n      .then((_props) => {\n        // Allow for re-assignment from lifecycle hook\n        props = _props === undefined ? props : _props\n        props = withoutRelations(mapper, props, opts)\n        op = opts.op = 'create'\n        this.dbg(op, mapper, props, opts)\n        return utils.resolve(this._create(mapper, props, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        result || (result = {})\n        let response = new Response(data, result, 'create')\n        response.created = data ? 1 : 0\n        response = this.respond(response, opts)\n\n        // afterCreate lifecycle hook\n        op = opts.op = 'afterCreate'\n        return utils.resolve(this[op](mapper, props, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Create multiple records in a single batch. Called by `Mapper#createMany`.\n   *\n   * @name Adapter#createMany\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The records to be created.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  createMany (mapper, props, opts) {\n    let op\n    props || (props = {})\n    opts || (opts = {})\n\n    // beforeCreateMany lifecycle hook\n    op = opts.op = 'beforeCreateMany'\n    return utils.resolve(this[op](mapper, props, opts))\n      .then((_props) => {\n        // Allow for re-assignment from lifecycle hook\n        props = _props === undefined ? props : _props\n        props = props.map((record) => withoutRelations(mapper, record, opts))\n        op = opts.op = 'createMany'\n        this.dbg(op, mapper, props, opts)\n        return utils.resolve(this._createMany(mapper, props, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        data || (data = [])\n        result || (result = {})\n        let response = new Response(data, result, 'createMany')\n        response.created = data.length\n        response = this.respond(response, opts)\n\n        // afterCreateMany lifecycle hook\n        op = opts.op = 'afterCreateMany'\n        return utils.resolve(this[op](mapper, props, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Destroy the record with the given primary key. Called by\n   * `Mapper#destroy`.\n   *\n   * @name Adapter#destroy\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to destroy.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  destroy (mapper, id, opts) {\n    let op\n    opts || (opts = {})\n\n    // beforeDestroy lifecycle hook\n    op = opts.op = 'beforeDestroy'\n    return utils.resolve(this[op](mapper, id, opts))\n      .then(() => {\n        op = opts.op = 'destroy'\n        this.dbg(op, mapper, id, opts)\n        return utils.resolve(this._destroy(mapper, id, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        result || (result = {})\n        let response = new Response(data, result, 'destroy')\n        response = this.respond(response, opts)\n\n        // afterDestroy lifecycle hook\n        op = opts.op = 'afterDestroy'\n        return utils.resolve(this[op](mapper, id, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Destroy the records that match the selection query. Called by\n   * `Mapper#destroyAll`.\n   *\n   * @name Adapter#destroyAll\n   * @method\n   * @param {Object} mapper the mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  destroyAll (mapper, query, opts) {\n    let op\n    query || (query = {})\n    opts || (opts = {})\n\n    // beforeDestroyAll lifecycle hook\n    op = opts.op = 'beforeDestroyAll'\n    return utils.resolve(this[op](mapper, query, opts))\n      .then(() => {\n        op = opts.op = 'destroyAll'\n        this.dbg(op, mapper, query, opts)\n        return utils.resolve(this._destroyAll(mapper, query, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        result || (result = {})\n        let response = new Response(data, result, 'destroyAll')\n        response = this.respond(response, opts)\n\n        // afterDestroyAll lifecycle hook\n        op = opts.op = 'afterDestroyAll'\n        return utils.resolve(this[op](mapper, query, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Load a belongsTo relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#loadBelongsTo\n   * @method\n   * @return {Promise}\n   */\n  loadBelongsTo (mapper, def, records, __opts) {\n    const relationDef = def.getRelation()\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      const record = records\n      return this.find(relationDef, this.makeBelongsToForeignKey(mapper, def, record), __opts)\n        .then((relatedItem) => {\n          def.setLocalField(record, relatedItem)\n        })\n    } else {\n      const keys = records\n        .map((record) => this.makeBelongsToForeignKey(mapper, def, record))\n        .filter((key) => key)\n      return this.findAll(relationDef, {\n        where: {\n          [relationDef.idAttribute]: {\n            'in': keys\n          }\n        }\n      }, __opts).then((relatedItems) => {\n        records.forEach((record) => {\n          relatedItems.forEach((relatedItem) => {\n            if (relatedItem[relationDef.idAttribute] === record[def.foreignKey]) {\n              def.setLocalField(record, relatedItem)\n            }\n          })\n        })\n      })\n    }\n  },\n\n  /**\n   * Retrieve the record with the given primary key. Called by `Mapper#find`.\n   *\n   * @name Adapter#find\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to retrieve.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @param {string[]} [opts.with=[]] Relations to eager load.\n   * @return {Promise}\n   */\n  find (mapper, id, opts) {\n    let record, op\n    let meta = {}\n    opts || (opts = {})\n    opts.with || (opts.with = [])\n\n    // beforeFind lifecycle hook\n    op = opts.op = 'beforeFind'\n    return utils.resolve(this[op](mapper, id, opts))\n      .then(() => {\n        op = opts.op = 'find'\n        this.dbg(op, mapper, id, opts)\n        return utils.resolve(this._find(mapper, id, opts))\n      })\n      .then((results) => {\n        let [_record, _meta] = results\n        if (!_record) {\n          return\n        }\n        record = _record\n        meta = _meta\n        const tasks = []\n\n        utils.forEachRelation(mapper, opts, (def, __opts) => {\n          let task\n          if (def.foreignKey && (def.type === 'hasOne' || def.type === 'hasMany')) {\n            if (def.type === 'hasOne') {\n              task = this.loadHasOne(mapper, def, record, __opts)\n            } else {\n              task = this.loadHasMany(mapper, def, record, __opts)\n            }\n          } else if (def.type === 'hasMany' && def.localKeys) {\n            task = this.loadHasManyLocalKeys(mapper, def, record, __opts)\n          } else if (def.type === 'hasMany' && def.foreignKeys) {\n            task = this.loadHasManyForeignKeys(mapper, def, record, __opts)\n          } else if (def.type === 'belongsTo') {\n            task = this.loadBelongsTo(mapper, def, record, __opts)\n          }\n          if (task) {\n            tasks.push(task)\n          }\n        })\n\n        return utils.Promise.all(tasks)\n      })\n      .then(() => {\n        let response = new Response(record, meta, 'find')\n        response.found = record ? 1 : 0\n        response = this.respond(response, opts)\n\n        // afterFind lifecycle hook\n        op = opts.op = 'afterFind'\n        return utils.resolve(this[op](mapper, id, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Retrieve the records that match the selection query.\n   *\n   * @name Adapter#findAll\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @param {string[]} [opts.with=[]] Relations to eager load.\n   * @return {Promise}\n   */\n  findAll (mapper, query, opts) {\n    opts || (opts = {})\n    opts.with || (opts.with = [])\n\n    let records = []\n    let meta = {}\n    let op\n    const activeWith = opts._activeWith\n\n    if (utils.isObject(activeWith)) {\n      const activeQuery = activeWith.query || {}\n      if (activeWith.replace) {\n        query = activeQuery\n      } else {\n        utils.deepFillIn(query, activeQuery)\n      }\n    }\n\n    // beforeFindAll lifecycle hook\n    op = opts.op = 'beforeFindAll'\n    return utils.resolve(this[op](mapper, query, opts))\n      .then(() => {\n        op = opts.op = 'findAll'\n        this.dbg(op, mapper, query, opts)\n        return utils.resolve(this._findAll(mapper, query, opts))\n      })\n      .then((results) => {\n        let [_records, _meta] = results\n        _records || (_records = [])\n        records = _records\n        meta = _meta\n        const tasks = []\n        utils.forEachRelation(mapper, opts, (def, __opts) => {\n          let task\n          if (def.foreignKey && (def.type === 'hasOne' || def.type === 'hasMany')) {\n            if (def.type === 'hasMany') {\n              task = this.loadHasMany(mapper, def, records, __opts)\n            } else {\n              task = this.loadHasOne(mapper, def, records, __opts)\n            }\n          } else if (def.type === 'hasMany' && def.localKeys) {\n            task = this.loadHasManyLocalKeys(mapper, def, records, __opts)\n          } else if (def.type === 'hasMany' && def.foreignKeys) {\n            task = this.loadHasManyForeignKeys(mapper, def, records, __opts)\n          } else if (def.type === 'belongsTo') {\n            task = this.loadBelongsTo(mapper, def, records, __opts)\n          }\n          if (task) {\n            tasks.push(task)\n          }\n        })\n        return utils.Promise.all(tasks)\n      })\n      .then(() => {\n        let response = new Response(records, meta, 'findAll')\n        response.found = records.length\n        response = this.respond(response, opts)\n\n        // afterFindAll lifecycle hook\n        op = opts.op = 'afterFindAll'\n        return utils.resolve(this[op](mapper, query, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Resolve the value of the specified option based on the given options and\n   * this adapter's settings. Override with care.\n   *\n   * @name Adapter#getOpt\n   * @method\n   * @param {string} opt The name of the option.\n   * @param {Object} [opts] Configuration options.\n   * @return {*} The value of the specified option.\n   */\n  getOpt (opt, opts) {\n    opts || (opts = {})\n    return opts[opt] === undefined ? utils.plainCopy(this[opt]) : utils.plainCopy(opts[opt])\n  },\n\n  /**\n   * Load a hasMany relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#loadHasMany\n   * @method\n   * @return {Promise}\n   */\n  loadHasMany (mapper, def, records, __opts) {\n    let singular = false\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      singular = true\n      records = [records]\n    }\n    const IDs = records.map((record) => this.makeHasManyForeignKey(mapper, def, record))\n    const query = {\n      where: {}\n    }\n    const criteria = query.where[def.foreignKey] = {}\n    if (singular) {\n      // more efficient query when we only have one record\n      criteria['=='] = IDs[0]\n    } else {\n      criteria['in'] = IDs.filter((id) => id)\n    }\n    return this.findAll(def.getRelation(), query, __opts).then((relatedItems) => {\n      records.forEach((record) => {\n        let attached = []\n        // avoid unneccesary iteration when we only have one record\n        if (singular) {\n          attached = relatedItems\n        } else {\n          relatedItems.forEach((relatedItem) => {\n            if (utils.get(relatedItem, def.foreignKey) === record[mapper.idAttribute]) {\n              attached.push(relatedItem)\n            }\n          })\n        }\n        def.setLocalField(record, attached)\n      })\n    })\n  },\n\n  loadHasManyLocalKeys (mapper, def, records, __opts) {\n    let record\n    const relatedMapper = def.getRelation()\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      record = records\n    }\n\n    if (record) {\n      return this.findAll(relatedMapper, {\n        where: {\n          [relatedMapper.idAttribute]: {\n            'in': this.makeHasManyLocalKeys(mapper, def, record)\n          }\n        }\n      }, __opts).then((relatedItems) => {\n        def.setLocalField(record, relatedItems)\n      })\n    } else {\n      let localKeys = []\n      records.forEach((record) => {\n        localKeys = localKeys.concat(this.makeHasManyLocalKeys(mapper, def, record))\n      })\n      return this.findAll(relatedMapper, {\n        where: {\n          [relatedMapper.idAttribute]: {\n            'in': unique(localKeys).filter((x) => x)\n          }\n        }\n      }, __opts).then((relatedItems) => {\n        records.forEach((item) => {\n          let attached = []\n          let itemKeys = utils.get(item, def.localKeys) || []\n          itemKeys = utils.isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\n          relatedItems.forEach((relatedItem) => {\n            if (itemKeys && itemKeys.indexOf(relatedItem[relatedMapper.idAttribute]) !== -1) {\n              attached.push(relatedItem)\n            }\n          })\n          def.setLocalField(item, attached)\n        })\n        return relatedItems\n      })\n    }\n  },\n\n  loadHasManyForeignKeys (mapper, def, records, __opts) {\n    const relatedMapper = def.getRelation()\n    const idAttribute = mapper.idAttribute\n    let record\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      record = records\n    }\n\n    if (record) {\n      return this.findAll(def.getRelation(), {\n        where: {\n          [def.foreignKeys]: {\n            'contains': this.makeHasManyForeignKeys(mapper, def, record)\n          }\n        }\n      }, __opts).then((relatedItems) => {\n        def.setLocalField(record, relatedItems)\n      })\n    } else {\n      return this.findAll(relatedMapper, {\n        where: {\n          [def.foreignKeys]: {\n            'isectNotEmpty': records.map((record) => this.makeHasManyForeignKeys(mapper, def, record))\n          }\n        }\n      }, __opts).then((relatedItems) => {\n        const foreignKeysField = def.foreignKeys\n        records.forEach((record) => {\n          const _relatedItems = []\n          const id = utils.get(record, idAttribute)\n          relatedItems.forEach((relatedItem) => {\n            const foreignKeys = utils.get(relatedItems, foreignKeysField) || []\n            if (foreignKeys.indexOf(id) !== -1) {\n              _relatedItems.push(relatedItem)\n            }\n          })\n          def.setLocalField(record, _relatedItems)\n        })\n      })\n    }\n  },\n\n  /**\n   * Load a hasOne relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#loadHasOne\n   * @method\n   * @return {Promise}\n   */\n  loadHasOne (mapper, def, records, __opts) {\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      records = [records]\n    }\n    return this.loadHasMany(mapper, def, records, __opts).then(() => {\n      records.forEach((record) => {\n        const relatedData = def.getLocalField(record)\n        if (utils.isArray(relatedData) && relatedData.length) {\n          def.setLocalField(record, relatedData[0])\n        }\n      })\n    })\n  },\n\n  /**\n   * Return the foreignKey from the given record for the provided relationship.\n   *\n   * There may be reasons why you may want to override this method, like when\n   * the id of the parent doesn't exactly match up to the key on the child.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeHasManyForeignKey\n   * @method\n   * @return {*}\n   */\n  makeHasManyForeignKey (mapper, def, record) {\n    return def.getForeignKey(record)\n  },\n\n  /**\n   * Return the localKeys from the given record for the provided relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeHasManyLocalKeys\n   * @method\n   * @return {*}\n   */\n  makeHasManyLocalKeys (mapper, def, record) {\n    let localKeys = []\n    let itemKeys = utils.get(record, def.localKeys) || []\n    itemKeys = utils.isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\n    localKeys = localKeys.concat(itemKeys)\n    return unique(localKeys).filter((x) => x)\n  },\n\n  /**\n   * Return the foreignKeys from the given record for the provided relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeHasManyForeignKeys\n   * @method\n   * @return {*}\n   */\n  makeHasManyForeignKeys (mapper, def, record) {\n    return utils.get(record, mapper.idAttribute)\n  },\n\n  /**\n   * Return the foreignKey from the given record for the provided relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeBelongsToForeignKey\n   * @method\n   * @return {*}\n   */\n  makeBelongsToForeignKey (mapper, def, record) {\n    return def.getForeignKey(record)\n  },\n\n  /**\n   * Retrieve sum of the specified field of the records that match the selection\n   * query. Called by `Mapper#sum`.\n   *\n   * @name Adapter#sum\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {string} field By to sum.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  sum (mapper, field, query, opts) {\n    let op\n    if (!utils.isString(field)) {\n      throw new Error('field must be a string!')\n    }\n    query || (query = {})\n    opts || (opts = {})\n\n    // beforeSum lifecycle hook\n    op = opts.op = 'beforeSum'\n    return utils.resolve(this[op](mapper, field, query, opts))\n      .then(() => {\n        // Allow for re-assignment from lifecycle hook\n        op = opts.op = 'sum'\n        this.dbg(op, mapper, field, query, opts)\n        return utils.resolve(this._sum(mapper, field, query, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        result || (result = {})\n        let response = new Response(data, result, op)\n        response = this.respond(response, opts)\n\n        // afterSum lifecycle hook\n        op = opts.op = 'afterSum'\n        return utils.resolve(this[op](mapper, field, query, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * @name Adapter#respond\n   * @method\n   * @param {Object} response Response object.\n   * @param {Object} opts Configuration options.\n   * return {Object} If `opts.raw == true` then return `response`, else return\n   * `response.data`.\n   */\n  respond (response, opts) {\n    return this.getOpt('raw', opts) ? response : response.data\n  },\n\n  /**\n   * Apply the given update to the record with the specified primary key. Called\n   * by `Mapper#update`.\n   *\n   * @name Adapter#update\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id The primary key of the record to be updated.\n   * @param {Object} props The update to apply to the record.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  update (mapper, id, props, opts) {\n    props || (props = {})\n    opts || (opts = {})\n    let op\n\n    // beforeUpdate lifecycle hook\n    op = opts.op = 'beforeUpdate'\n    return utils.resolve(this[op](mapper, id, props, opts))\n      .then((_props) => {\n        // Allow for re-assignment from lifecycle hook\n        props = _props === undefined ? props : _props\n        props = withoutRelations(mapper, props, opts)\n        op = opts.op = 'update'\n        this.dbg(op, mapper, id, props, opts)\n        return utils.resolve(this._update(mapper, id, props, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        result || (result = {})\n        let response = new Response(data, result, 'update')\n        response.updated = data ? 1 : 0\n        response = this.respond(response, opts)\n\n        // afterUpdate lifecycle hook\n        op = opts.op = 'afterUpdate'\n        return utils.resolve(this[op](mapper, id, props, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Apply the given update to all records that match the selection query.\n   * Called by `Mapper#updateAll`.\n   *\n   * @name Adapter#updateAll\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The update to apply to the selected records.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  updateAll (mapper, props, query, opts) {\n    props || (props = {})\n    query || (query = {})\n    opts || (opts = {})\n    let op\n\n    // beforeUpdateAll lifecycle hook\n    op = opts.op = 'beforeUpdateAll'\n    return utils.resolve(this[op](mapper, props, query, opts))\n      .then((_props) => {\n        // Allow for re-assignment from lifecycle hook\n        props = _props === undefined ? props : _props\n        props = withoutRelations(mapper, props, opts)\n        op = opts.op = 'updateAll'\n        this.dbg(op, mapper, props, query, opts)\n        return utils.resolve(this._updateAll(mapper, props, query, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        data || (data = [])\n        result || (result = {})\n        let response = new Response(data, result, 'updateAll')\n        response.updated = data.length\n        response = this.respond(response, opts)\n\n        // afterUpdateAll lifecycle hook\n        op = opts.op = 'afterUpdateAll'\n        return utils.resolve(this[op](mapper, props, query, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  },\n\n  /**\n   * Update the given records in a single batch. Called by `Mapper#updateMany`.\n   *\n   * @name Adapter#updateMany\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object[]} records The records to update.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  updateMany (mapper, records, opts) {\n    records || (records = [])\n    opts || (opts = {})\n    let op\n    const idAttribute = mapper.idAttribute\n\n    records = records.filter((record) => utils.get(record, idAttribute))\n\n    // beforeUpdateMany lifecycle hook\n    op = opts.op = 'beforeUpdateMany'\n    return utils.resolve(this[op](mapper, records, opts))\n      .then((_records) => {\n        // Allow for re-assignment from lifecycle hook\n        records = _records === undefined ? records : _records\n        records = records.map((record) => withoutRelations(mapper, record, opts))\n        op = opts.op = 'updateMany'\n        this.dbg(op, mapper, records, opts)\n        return utils.resolve(this._updateMany(mapper, records, opts))\n      })\n      .then((results) => {\n        let [data, result] = results\n        data || (data = [])\n        result || (result = {})\n        let response = new Response(data, result, 'updateMany')\n        response.updated = data.length\n        response = this.respond(response, opts)\n\n        // afterUpdateMany lifecycle hook\n        op = opts.op = 'afterUpdateMany'\n        return utils.resolve(this[op](mapper, records, opts, response))\n          .then((_response) => _response === undefined ? response : _response)\n      })\n  }\n})\n\n/**\n * Create a subclass of this Adapter:\n *\n * @example <caption>Adapter.extend</caption>\n * // Normally you would do: import {Adapter} from 'js-data'\n * const JSData = require('js-data@3.0.0-beta.10')\n * const {Adapter} = JSData\n * console.log('Using JSData v' + JSData.version.full)\n *\n * // Extend the class using ES2015 class syntax.\n * class CustomAdapterClass extends Adapter {\n *   foo () { return 'bar' }\n *   static beep () { return 'boop' }\n * }\n * const customAdapter = new CustomAdapterClass()\n * console.log(customAdapter.foo())\n * console.log(CustomAdapterClass.beep())\n *\n * // Extend the class using alternate method.\n * const OtherAdapterClass = Adapter.extend({\n *   foo () { return 'bar' }\n * }, {\n *   beep () { return 'boop' }\n * })\n * const otherAdapter = new OtherAdapterClass()\n * console.log(otherAdapter.foo())\n * console.log(OtherAdapterClass.beep())\n *\n * // Extend the class, providing a custom constructor.\n * function AnotherAdapterClass () {\n *   Adapter.call(this)\n *   this.created_at = new Date().getTime()\n * }\n * Adapter.extend({\n *   constructor: AnotherAdapterClass,\n *   foo () { return 'bar' }\n * }, {\n *   beep () { return 'boop' }\n * })\n * const anotherAdapter = new AnotherAdapterClass()\n * console.log(anotherAdapter.created_at)\n * console.log(anotherAdapter.foo())\n * console.log(AnotherAdapterClass.beep())\n *\n * @method Adapter.extend\n * @param {Object} [props={}] Properties to add to the prototype of the\n * subclass.\n * @param {Object} [props.constructor] Provide a custom constructor function\n * to be used as the subclass itself.\n * @param {Object} [classProps={}] Static properties to add to the subclass.\n * @returns {Constructor} Subclass of this Adapter class.\n */\n","import {Query, utils} from 'js-data'\nimport {Adapter} from '../node_modules/js-data-adapter/src/index'\nimport firebase from 'firebase'\n\nfunction isValidString (value) {\n  return (value != null && value !== '')\n}\n\nfunction join (items, separator) {\n  separator || (separator = '')\n  return items.filter(isValidString).join(separator)\n}\n\nfunction makePath (...args) { // eslint-disable-line no-unused-vars\n  let result = join(args, '/')\n  return result.replace(/([^:\\/]|^)\\/{2,}/g, '$1/')\n}\n\nlet queue = []\nlet taskInProcess = false\n\nfunction enqueue (task) {\n  queue.push(task)\n}\n\nfunction dequeue () {\n  if (queue.length && !taskInProcess) {\n    taskInProcess = true\n    queue[0]()\n  }\n}\n\nfunction queueTask (task) {\n  if (!queue.length) {\n    enqueue(task)\n    dequeue()\n  } else {\n    enqueue(task)\n  }\n}\n\nfunction createTask (fn) {\n  return new utils.Promise(fn).then((result) => {\n    taskInProcess = false\n    queue.shift()\n    setTimeout(dequeue, 0)\n    return result\n  }, (err) => {\n    taskInProcess = false\n    queue.shift()\n    setTimeout(dequeue, 0)\n    return utils.reject(err)\n  })\n}\n\nconst __super__ = Adapter.prototype\n\n/**\n * FirebaseAdapter class.\n *\n * @example <caption>Browser</caption>\n * import {DataStore} from 'js-data'\n * import firebase from 'firebase'\n * import {FirebaseAdapter} from 'js-data-firebase'\n * const store = new DataStore()\n * firebase.initializeApp({\n *   apiKey: 'your-api-key',\n *   databaseURL: 'your-database-url'\n * })\n * const adapter = new FirebaseAdapter({ db: firebase.database() })\n * store.registerAdapter('firebase', adapter, { 'default': true })\n *\n * @example <caption>Node.js</caption>\n * import {Container} from 'js-data'\n * import firebase from 'firebase'\n * import {FirebaseAdapter} from 'js-data-firebase'\n * const store = new Container()\n * firebase.initializeApp({\n *   databaseURL: 'your-database-url',\n *   serviceAccount: 'path/to/keyfile'\n * })\n * const adapter = new FirebaseAdapter({ db: firebase.database() })\n * store.registerAdapter('firebase', adapter, { 'default': true })\n *\n * @class FirebaseAdapter\n * @param {Object} [opts] Configuration opts.\n * @param {Object} [opts.db] See {@link FirebaseAdapter#db}\n * @param {boolean} [opts.debug=false] See {@link Adapter#debug}.\n * @param {boolean} [opts.raw=false] See {@link Adapter#raw}.\n */\nexport function FirebaseAdapter (opts) {\n  utils.classCallCheck(this, FirebaseAdapter)\n  opts || (opts = {})\n  Adapter.call(this, opts)\n\n  /**\n   * The database instance used by this adapter.\n   *\n   * @name FirebaseAdapter#db\n   * @type {Object}\n   * @default firebase.database()\n   */\n  if (opts.db) {\n    this.db = opts.db || firebase.database()\n  }\n}\n\n// Setup prototype inheritance from Adapter\nFirebaseAdapter.prototype = Object.create(Adapter.prototype, {\n  constructor: {\n    value: FirebaseAdapter,\n    enumerable: false,\n    writable: true,\n    configurable: true\n  }\n})\n\nObject.defineProperty(FirebaseAdapter, '__super__', {\n  configurable: true,\n  value: Adapter\n})\n\n/**\n * Alternative to ES6 class syntax for extending `FirebaseAdapter`.\n *\n * @example <caption>Using the ES2015 class syntax.</caption>\n * class MyFirebaseAdapter extends FirebaseAdapter {...}\n * const adapter = new MyFirebaseAdapter()\n *\n * @example <caption>Using {@link FirebaseAdapter.extend}.</caption>\n * var instanceProps = {...}\n * var classProps = {...}\n *\n * var MyFirebaseAdapter = FirebaseAdapter.extend(instanceProps, classProps)\n * var adapter = new MyFirebaseAdapter()\n *\n * @method FirebaseAdapter.extend\n * @static\n * @param {Object} [instanceProps] Properties that will be added to the\n * prototype of the subclass.\n * @param {Object} [classProps] Properties that will be added as static\n * properties to the subclass itself.\n * @return {Constructor} Subclass of `FirebaseAdapter`.\n */\nFirebaseAdapter.extend = utils.extend\n\nutils.addHiddenPropsToTarget(FirebaseAdapter.prototype, {\n  /**\n   * Retrieve the number of records that match the selection query. Internal\n   * method used by Adapter#count.\n   *\n   * @name FirebaseAdapter#_count\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} query Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _count (mapper, query, opts) {\n    query || (query = {})\n    opts || (opts = {})\n    return this._findAll(mapper, query, opts).then((result) => {\n      result[0] = result[0].length\n      return result\n    })\n  },\n\n  /**\n   * Create a new record. Internal method used by Adapter#create.\n   *\n   * @name FirebaseAdapter#_create\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The record to be created.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _create (mapper, props, opts) {\n    props || (props = {})\n    opts || (opts = {})\n    return this._upsert(mapper, props, opts)\n  },\n\n  _upsert (mapper, props, opts) {\n    const _props = utils.plainCopy(props)\n    opts || (opts = {})\n\n    const id = utils.get(_props, mapper.idAttribute)\n    const collectionRef = this.getRef(mapper, opts)\n\n    let itemRef\n\n    if (utils.isSorN(id)) {\n      itemRef = collectionRef.child(id)\n    } else {\n      itemRef = collectionRef.push()\n      utils.set(_props, mapper.idAttribute, itemRef.key)\n    }\n\n    return itemRef.set(_props)\n      .then(() => this._once(itemRef))\n      .then((record) => {\n        if (!record) {\n          throw new Error('Not Found')\n        }\n        return [record, { ref: itemRef }]\n      })\n  },\n\n  _upsertBatch (mapper, records, opts) {\n    opts || (opts = {})\n\n    const idAttribute = mapper.idAttribute\n    const refValueCollection = []\n    const collectionRef = this.getRef(mapper, opts)\n\n    // generate path for each\n    records.forEach((record) => {\n      const id = utils.get(record, idAttribute)\n      let _props = utils.plainCopy(record)\n      let itemRef\n\n      if (utils.isSorN(id)) {\n        itemRef = collectionRef.child(id)\n      } else {\n        itemRef = collectionRef.push()\n        utils.set(_props, idAttribute, itemRef.key)\n      }\n      refValueCollection.push({ ref: itemRef, props: _props })\n    })\n\n    return this._atomicUpdate(mapper, refValueCollection, opts)\n      .then(() => {\n        // since UDFs and timestamps can alter values on write, let's get the latest values\n        return utils.Promise.all(refValueCollection.map((item) => this._once(item.ref)))\n      })\n      .then((records) => {\n        // just return the updated records and not the refs?\n        return [records, { ref: refValueCollection.map((item) => item.ref) }]\n      })\n  },\n\n  _once (ref) {\n    return ref.once('value').then((dataSnapshot) => {\n      if (!dataSnapshot.exists()) {\n        return null\n      }\n      return dataSnapshot.val()\n    })\n  },\n\n  _atomicUpdate (mapper, refValueCollection, opts) { // collection of refs and the new value to set at that ref\n    // do a deep-path update off the database\n    // see https://www.firebase.com/blog/2015-09-24-atomic-writes-and-more.html\n    let atomicUpdate = {}\n    refValueCollection.forEach((item) => {\n      atomicUpdate[item.ref.toString().replace(this.getRef(mapper, opts).toString(), '')] = item.props\n    })\n    return this.getRef(mapper, opts).update(atomicUpdate)\n  },\n\n  /**\n   * Create multiple records in a single batch. Internal method used by\n   * Adapter#createMany.\n   *\n   * @name FirebaseAdapter#_createMany\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} records The records to be created.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _createMany (mapper, records, opts) {\n    opts || (opts = {})\n    return this._upsertBatch(mapper, records, opts)\n  },\n\n  /**\n   * Destroy the record with the given primary key. Internal method used by\n   * Adapter#destroy.\n   *\n   * @name FirebaseAdapter#_destroy\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to destroy.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _destroy (mapper, id, opts) {\n    opts || (opts = {})\n    const ref = this.getRef(mapper, opts).child(id)\n    return ref.remove().then(() => [undefined, { ref }])\n  },\n\n  /**\n   * Destroy the records that match the selection query. Internal method used by\n   * Adapter#destroyAll.\n   *\n   * @name FirebaseAdapter#_destroyAll\n   * @method\n   * @private\n   * @param {Object} mapper the mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _destroyAll (mapper, query, opts) {\n    query || (query = {})\n    opts || (opts = {})\n\n    return this._findAll(mapper, query)\n      .then((results) => {\n        const [records] = results\n        const idAttribute = mapper.idAttribute\n        return utils.Promise.all(records.map((record) => {\n          return this._destroy(mapper, utils.get(record, idAttribute), opts)\n        }))\n      })\n      .then(() => [undefined, {}])\n  },\n\n  /**\n   * Retrieve the record with the given primary key. Internal method used by\n   * Adapter#find.\n   *\n   * @name FirebaseAdapter#_find\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to retrieve.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _find (mapper, id, opts) {\n    opts || (opts = {})\n    const itemRef = this.getRef(mapper, opts).child(id)\n    return this._once(itemRef).then((record) => [record, { ref: itemRef }])\n  },\n  /**\n    * Retrieve the records that match the selection query. Internal method used\n    * by Adapter#findAll.\n    *\n    * @name FirebaseAdapter#_findAll\n    * @method\n    * @private\n    * @param {Object} mapper The mapper.\n    * @param {Object} query Selection query.\n    * @param {Object} [opts] Configuration options.\n    * @return {Promise}\n    */\n  _findAll (mapper, query, opts) {\n    query || (query = {})\n    opts || (opts = {})\n\n    const collectionRef = this.getRef(mapper, opts)\n\n    return collectionRef.once('value').then((dataSnapshot) => {\n      const data = dataSnapshot.val()\n      if (!data) {\n        return [[], { ref: collectionRef }]\n      }\n      const records = []\n      utils.forOwn(data, (value, key) => {\n        records.push(value)\n      })\n      const _query = new Query({\n        index: {\n          getAll () {\n            return records\n          }\n        }\n      })\n      return [_query.filter(query).run(), { ref: collectionRef }]\n    })\n  },\n\n  /**\n   * Retrieve the number of records that match the selection query. Internal\n   * method used by Adapter#sum.\n   *\n   * @name FirebaseAdapter#_sum\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {string} field The field to sum.\n   * @param {Object} query Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _sum (mapper, field, query, opts) {\n    return this._findAll(mapper, query, opts).then((result) => {\n      result[0] = result[0].reduce((sum, record) => sum + (utils.get(record, field) || 0), 0)\n      return result\n    })\n  },\n\n  /**\n   * Apply the given update to the record with the specified primary key.\n   * Internal method used by Adapter#update.\n   *\n   * @name FirebaseAdapter#_update\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id The primary key of the record to be updated.\n   * @param {Object} props The update to apply to the record.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _update (mapper, id, props, opts) {\n    props || (props = {})\n    opts || (opts = {})\n\n    const itemRef = this.getRef(mapper, opts).child(id)\n    return this._once(itemRef)\n      .then((currentVal) => {\n        if (!currentVal) {\n          throw new Error('Not Found')\n        }\n        utils.deepMixIn(currentVal, props)\n        return itemRef.set(currentVal)\n      })\n      .then(() => this._once(itemRef))\n      .then((record) => {\n        if (!record) {\n          throw new Error('Not Found')\n        }\n        return [record, { ref: itemRef }]\n      })\n  },\n\n  /**\n   * Apply the given update to all records that match the selection query.\n   * Internal method used by Adapter#updateAll.\n   *\n   * @name FirebaseAdapter#_updateAll\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The update to apply to the selected records.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _updateAll (mapper, props, query, opts) {\n    opts || (opts = {})\n    props || (props = {})\n    query || (query = {})\n\n    return this._findAll(mapper, query, opts).then((results) => {\n      const [records] = results\n      records.forEach((record) => utils.deepMixIn(record, props))\n      return this._upsertBatch(mapper, records, opts)\n    })\n  },\n\n  /**\n   * Update the given records in a single batch. Internal method used by\n   * Adapter#updateMany.\n   *\n   * @name FirebaseAdapter#updateMany\n   * @method\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object[]} records The records to update.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _updateMany (mapper, records, opts) {\n    opts || (opts = {})\n    return this._upsertBatch(mapper, records, opts)\n  },\n\n  getRef (mapper, opts) {\n    opts = opts || {}\n    return this.db.ref().child(opts.endpoint || mapper.endpoint || mapper.name)\n  },\n\n  create (mapper, props, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.create.call(this, mapper, props, opts).then(success, failure)\n      })\n    })\n  },\n\n  createMany (mapper, props, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.createMany.call(this, mapper, props, opts).then(success, failure)\n      })\n    })\n  },\n\n  destroy (mapper, id, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.destroy.call(this, mapper, id, opts).then(success, failure)\n      })\n    })\n  },\n\n  destroyAll (mapper, query, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.destroyAll.call(this, mapper, query, opts).then(success, failure)\n      })\n    })\n  },\n\n  update (mapper, id, props, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.update.call(this, mapper, id, props, opts).then(success, failure)\n      })\n    })\n  },\n\n  updateAll (mapper, props, query, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.updateAll.call(this, mapper, props, query, opts).then(success, failure)\n      })\n    })\n  },\n\n  updateMany (mapper, records, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.updateMany.call(this, mapper, records, opts).then(success, failure)\n      })\n    })\n  }\n})\n\n/**\n * Details of the current version of the `js-data-firebase` module.\n *\n * @name FirebaseAdapter.version\n * @type {Object}\n * @property {string} version.full The full semver value.\n * @property {number} version.major The major version number.\n * @property {number} version.minor The minor version number.\n * @property {number} version.patch The patch version number.\n * @property {(string|boolean)} version.alpha The alpha version value,\n * otherwise `false` if the current version is not alpha.\n * @property {(string|boolean)} version.beta The beta version value,\n * otherwise `false` if the current version is not beta.\n */\n\nexport const version = '<%= version %>'\n\n/**\n * {@link FirebaseAdapter} class.\n *\n * @name module:js-data-firebase.FirebaseAdapter\n * @see FirebaseAdapter\n */\n\n/**\n * Registered as `js-data-firebase` in NPM and Bower.\n *\n * @example <caption>Script tag</caption>\n * var FirebaseAdapter = window.JSDataFirebase.FirebaseAdapter\n * var adapter = new FirebaseAdapter()\n *\n * @example <caption>CommonJS</caption>\n * var FirebaseAdapter = require('js-data-firebase').FirebaseAdapter\n * var adapter = new FirebaseAdapter()\n *\n * @example <caption>ES2015 Modules</caption>\n * import {FirebaseAdapter} from 'js-data-firebase'\n * const adapter = new FirebaseAdapter()\n *\n * @example <caption>AMD</caption>\n * define('myApp', ['js-data-firebase'], function (JSDataFirebase) {\n *   var FirebaseAdapter = JSDataFirebase.FirebaseAdapter\n *   var adapter = new FirebaseAdapter()\n *\n *   // ...\n * })\n *\n * @module js-data-firebase\n */\n"],"names":["noop","args","opts","length","dbg","op","utils","resolve","noop2","unique","array","seen","final","forEach","item","push","withoutRelations","mapper","props","with","relationFields","toStrip","filter","value","indexOf","omit","Response","data","meta","fillIn","DEFAULTS","debug","raw","Adapter","classCallCheck","Component","call","extend","constructor","afterCount","afterCreate","afterCreateMany","afterDestroy","afterDestroyAll","afterFind","afterFindAll","afterSum","afterUpdate","afterUpdateAll","afterUpdateMany","beforeCount","beforeCreate","beforeCreateMany","beforeDestroy","beforeDestroyAll","beforeFind","beforeFindAll","beforeSum","beforeUpdate","beforeUpdateAll","beforeUpdateMany","count","query","then","_count","results","result","response","respond","_response","undefined","create","_props","_create","created","createMany","map","record","_createMany","destroy","id","_destroy","destroyAll","_destroyAll","loadBelongsTo","def","records","__opts","relationDef","getRelation","isObject","isArray","find","makeBelongsToForeignKey","relatedItem","setLocalField","keys","key","findAll","where","idAttribute","relatedItems","foreignKey","_find","_record","_meta","tasks","forEachRelation","task","type","loadHasOne","loadHasMany","localKeys","loadHasManyLocalKeys","foreignKeys","loadHasManyForeignKeys","Promise","all","found","activeWith","_activeWith","activeQuery","replace","deepFillIn","_findAll","_records","getOpt","opt","plainCopy","singular","IDs","makeHasManyForeignKey","criteria","attached","get","relatedMapper","makeHasManyLocalKeys","concat","x","itemKeys","Object","makeHasManyForeignKeys","foreignKeysField","_relatedItems","relatedData","getLocalField","getForeignKey","sum","field","isString","Error","_sum","update","_update","updated","updateAll","_updateAll","updateMany","_updateMany","queue","taskInProcess","enqueue","dequeue","queueTask","createTask","fn","shift","setTimeout","err","reject","__super__","prototype","FirebaseAdapter","db","firebase","database","enumerable","writable","configurable","defineProperty","addHiddenPropsToTarget","_upsert","collectionRef","getRef","itemRef","isSorN","child","set","_once","ref","_upsertBatch","refValueCollection","_atomicUpdate","once","dataSnapshot","exists","val","atomicUpdate","toString","remove","forOwn","_query","Query","index","getAll","run","reduce","currentVal","deepMixIn","endpoint","name","success","failure","version"],"mappings":";;;;;;;;EACA,IAAI,OAAO,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,OAAO,MAAM,CAAC,QAAQ,KAAK,QAAQ,GAAG,UAAU,GAAG,EAAE;AACnG,EAAA,EAAE,OAAO,OAAO,GAAG,CAAC;AACpB,EAAA,CAAC,GAAG,UAAU,GAAG,EAAE;AACnB,EAAA,EAAE,OAAO,GAAG,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,GAAG,CAAC,WAAW,KAAK,MAAM,IAAI,GAAG,KAAK,MAAM,CAAC,SAAS,GAAG,QAAQ,GAAG,OAAO,GAAG,CAAC;AAC/H,EAAA,CAAC,CAAC;;AAEF,EA0DO,IAAI,cAAc,GAAG,YAAY;AACxC,EAAA,EAAE,SAAS,UAAU,CAAC,KAAK,EAAE;AAC7B,EAAA,IAAI,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACvB,EAAA,GAAG;;AAEH,EAAA,EAAE,SAAS,cAAc,CAAC,GAAG,EAAE;AAC/B,EAAA,IAAI,IAAI,KAAK,EAAE,IAAI,CAAC;;AAEpB,EAAA,IAAI,SAAS,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE;AAC5B,EAAA,MAAM,OAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,EAAE;AACpD,EAAA,QAAQ,IAAI,OAAO,GAAG;AACtB,EAAA,UAAU,GAAG,EAAE,GAAG;AAClB,EAAA,UAAU,GAAG,EAAE,GAAG;AAClB,EAAA,UAAU,OAAO,EAAE,OAAO;AAC1B,EAAA,UAAU,MAAM,EAAE,MAAM;AACxB,EAAA,UAAU,IAAI,EAAE,IAAI;AACpB,EAAA,SAAS,CAAC;;AAEV,EAAA,QAAQ,IAAI,IAAI,EAAE;AAClB,EAAA,UAAU,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC;AACrC,EAAA,SAAS,MAAM;AACf,EAAA,UAAU,KAAK,GAAG,IAAI,GAAG,OAAO,CAAC;AACjC,EAAA,UAAU,MAAM,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC3B,EAAA,SAAS;AACT,EAAA,OAAO,CAAC,CAAC;AACT,EAAA,KAAK;;AAEL,EAAA,IAAI,SAAS,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE;AAC9B,EAAA,MAAM,IAAI;AACV,EAAA,QAAQ,IAAI,MAAM,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AACnC,EAAA,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;;AAEjC,EAAA,QAAQ,IAAI,KAAK,YAAY,UAAU,EAAE;AACzC,EAAA,UAAU,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,UAAU,GAAG,EAAE;AAC3D,EAAA,YAAY,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;AAChC,EAAA,WAAW,EAAE,UAAU,GAAG,EAAE;AAC5B,EAAA,YAAY,MAAM,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;AACjC,EAAA,WAAW,CAAC,CAAC;AACb,EAAA,SAAS,MAAM;AACf,EAAA,UAAU,MAAM,CAAC,MAAM,CAAC,IAAI,GAAG,QAAQ,GAAG,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC;AAClE,EAAA,SAAS;AACT,EAAA,OAAO,CAAC,OAAO,GAAG,EAAE;AACpB,EAAA,QAAQ,MAAM,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;AAC7B,EAAA,OAAO;AACP,EAAA,KAAK;;AAEL,EAAA,IAAI,SAAS,MAAM,CAAC,IAAI,EAAE,KAAK,EAAE;AACjC,EAAA,MAAM,QAAQ,IAAI;AAClB,EAAA,QAAQ,KAAK,QAAQ;AACrB,EAAA,UAAU,KAAK,CAAC,OAAO,CAAC;AACxB,EAAA,YAAY,KAAK,EAAE,KAAK;AACxB,EAAA,YAAY,IAAI,EAAE,IAAI;AACtB,EAAA,WAAW,CAAC,CAAC;AACb,EAAA,UAAU,MAAM;;AAEhB,EAAA,QAAQ,KAAK,OAAO;AACpB,EAAA,UAAU,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AAC9B,EAAA,UAAU,MAAM;;AAEhB,EAAA,QAAQ;AACR,EAAA,UAAU,KAAK,CAAC,OAAO,CAAC;AACxB,EAAA,YAAY,KAAK,EAAE,KAAK;AACxB,EAAA,YAAY,IAAI,EAAE,KAAK;AACvB,EAAA,WAAW,CAAC,CAAC;AACb,EAAA,UAAU,MAAM;AAChB,EAAA,OAAO;;AAEP,EAAA,MAAM,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC;;AAEzB,EAAA,MAAM,IAAI,KAAK,EAAE;AACjB,EAAA,QAAQ,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC;AACrC,EAAA,OAAO,MAAM;AACb,EAAA,QAAQ,IAAI,GAAG,IAAI,CAAC;AACpB,EAAA,OAAO;AACP,EAAA,KAAK;;AAEL,EAAA,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;;AAExB,EAAA,IAAI,IAAI,OAAO,GAAG,CAAC,MAAM,KAAK,UAAU,EAAE;AAC1C,EAAA,MAAM,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;AAC9B,EAAA,KAAK;AACL,EAAA,GAAG;;AAEH,EAAA,EAAE,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,aAAa,EAAE;AAC5D,EAAA,IAAI,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,YAAY;AACjE,EAAA,MAAM,OAAO,IAAI,CAAC;AAClB,EAAA,KAAK,CAAC;AACN,EAAA,GAAG;;AAEH,EAAA,EAAE,cAAc,CAAC,SAAS,CAAC,IAAI,GAAG,UAAU,GAAG,EAAE;AACjD,EAAA,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;AACrC,EAAA,GAAG,CAAC;;AAEJ,EAAA,EAAE,cAAc,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,GAAG,EAAE;AAClD,EAAA,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;AACtC,EAAA,GAAG,CAAC;;AAEJ,EAAA,EAAE,cAAc,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,GAAG,EAAE;AACnD,EAAA,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;AACvC,EAAA,GAAG,CAAC;;AAEJ,EAAA,EAAE,OAAO;AACT,EAAA,IAAI,IAAI,EAAE,UAAU,EAAE,EAAE;AACxB,EAAA,MAAM,OAAO,YAAY;AACzB,EAAA,QAAQ,OAAO,IAAI,cAAc,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;AAC7D,EAAA,OAAO,CAAC;AACR,EAAA,KAAK;AACL,EAAA,IAAI,KAAK,EAAE,UAAU,KAAK,EAAE;AAC5B,EAAA,MAAM,OAAO,IAAI,UAAU,CAAC,KAAK,CAAC,CAAC;AACnC,EAAA,KAAK;AACL,EAAA,GAAG,CAAC;AACJ,EAAA,CAAC,EAAE,CAAC;;AAEJ,EAmIO,IAAI,cAAc,GAAG,UAAU,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE;AACvD,EAAA,EAAE,IAAI,GAAG,IAAI,GAAG,EAAE;AAClB,EAAA,IAAI,MAAM,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE;AACpC,EAAA,MAAM,KAAK,EAAE,KAAK;AAClB,EAAA,MAAM,UAAU,EAAE,IAAI;AACtB,EAAA,MAAM,YAAY,EAAE,IAAI;AACxB,EAAA,MAAM,QAAQ,EAAE,IAAI;AACpB,EAAA,KAAK,CAAC,CAAC;AACP,EAAA,GAAG,MAAM;AACT,EAAA,IAAI,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;AACrB,EAAA,GAAG;;AAEH,EAAA,EAAE,OAAO,GAAG,CAAC;AACb,EAAA,CAAC,CAAC;;AAEF,EA4IO,IAAI,aAAa,GAAG,YAAY;AACvC,EAAA,EAAE,SAAS,aAAa,CAAC,GAAG,EAAE,CAAC,EAAE;AACjC,EAAA,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC;AAClB,EAAA,IAAI,IAAI,EAAE,GAAG,IAAI,CAAC;AAClB,EAAA,IAAI,IAAI,EAAE,GAAG,KAAK,CAAC;AACnB,EAAA,IAAI,IAAI,EAAE,GAAG,SAAS,CAAC;;AAEvB,EAAA,IAAI,IAAI;AACR,EAAA,MAAM,KAAK,IAAI,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,IAAI,EAAE;AAC1F,EAAA,QAAQ,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;;AAE5B,EAAA,QAAQ,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE,MAAM;AAC1C,EAAA,OAAO;AACP,EAAA,KAAK,CAAC,OAAO,GAAG,EAAE;AAClB,EAAA,MAAM,EAAE,GAAG,IAAI,CAAC;AAChB,EAAA,MAAM,EAAE,GAAG,GAAG,CAAC;AACf,EAAA,KAAK,SAAS;AACd,EAAA,MAAM,IAAI;AACV,EAAA,QAAQ,IAAI,CAAC,EAAE,IAAI,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC;AAChD,EAAA,OAAO,SAAS;AAChB,EAAA,QAAQ,IAAI,EAAE,EAAE,MAAM,EAAE,CAAC;AACzB,EAAA,OAAO;AACP,EAAA,KAAK;;AAEL,EAAA,IAAI,OAAO,IAAI,CAAC;AAChB,EAAA,GAAG;;AAEH,EAAA,EAAE,OAAO,UAAU,GAAG,EAAE,CAAC,EAAE;AAC3B,EAAA,IAAI,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;AAC5B,EAAA,MAAM,OAAO,GAAG,CAAC;AACjB,EAAA,KAAK,MAAM,IAAI,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,GAAG,CAAC,EAAE;AAC/C,EAAA,MAAM,OAAO,aAAa,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;AACnC,EAAA,KAAK,MAAM;AACX,EAAA,MAAM,MAAM,IAAI,SAAS,CAAC,sDAAsD,CAAC,CAAC;AAClF,EAAA,KAAK;AACL,EAAA,GAAG,CAAC;AACJ,EAAA,CAAC,EAAE,CAAC;;EClfG,IAAMA,OAAO,SAAPA,IAAO,GAAmB;AAAA,EAAA,oCAANC,IAAM;AAANA,EAAAA,QAAM;AAAA,EAAA;;AACrC,EAAA,MAAMC,OAAOD,KAAKA,KAAKE,MAAL,GAAc,CAAnB,CAAb;AACA,EAAA,OAAKC,GAAL,cAASF,KAAKG,EAAd,SAAqBJ,IAArB;AACA,EAAA,SAAOK,aAAMC,OAAN,EAAP;AACD,EAAA,CAJM;;AAMP,EAAO,IAAMC,QAAQ,SAARA,KAAQ,GAAmB;AAAA,EAAA,qCAANP,IAAM;AAANA,EAAAA,QAAM;AAAA,EAAA;;AACtC,EAAA,MAAMC,OAAOD,KAAKA,KAAKE,MAAL,GAAc,CAAnB,CAAb;AACA,EAAA,OAAKC,GAAL,cAASF,KAAKG,EAAd,SAAqBJ,IAArB;AACA,EAAA,SAAOK,aAAMC,OAAN,EAAP;AACD,EAAA,CAJM;;AAMP,EAAO,IAAME,SAAS,SAATA,MAAS,CAAUC,KAAV,EAAiB;AACrC,EAAA,MAAMC,OAAO,EAAb;AACA,EAAA,MAAMC,QAAQ,EAAd;AACAF,EAAAA,QAAMG,OAAN,CAAc,UAAUC,IAAV,EAAgB;AAC5B,EAAA,QAAIA,QAAQH,IAAZ,EAAkB;AAChB,EAAA;AACD,EAAA;AACDC,EAAAA,UAAMG,IAAN,CAAWD,IAAX;AACAH,EAAAA,SAAKG,IAAL,IAAa,CAAb;AACD,EAAA,GAND;AAOA,EAAA,SAAOF,KAAP;AACD,EAAA,CAXM;;AAaP,EAAO,IAAMI,mBAAmB,SAAnBA,gBAAmB,CAAUC,MAAV,EAAkBC,KAAlB,EAAyBhB,IAAzB,EAA+B;AAC7DA,EAAAA,WAASA,OAAO,EAAhB;AACAA,EAAAA,OAAKiB,IAAL,KAAcjB,KAAKiB,IAAL,GAAY,EAA1B;AACA,EAAA,MAAMC,iBAAiBH,OAAOG,cAAP,IAAyB,EAAhD;AACA,EAAA,MAAMC,UAAUD,eAAeE,MAAf,CAAsB,UAACC,KAAD;AAAA,EAAA,WAAWrB,KAAKiB,IAAL,CAAUK,OAAV,CAAkBD,KAAlB,MAA6B,CAAC,CAAzC;AAAA,EAAA,GAAtB,CAAhB;AACA,EAAA,SAAOjB,aAAMmB,IAAN,CAAWP,KAAX,EAAkBG,OAAlB,CAAP;AACD,EAAA,CANM;;AAQP,EASA;;;;;;AAMA,EAAO,SAASK,QAAT,CAAmBC,IAAnB,EAAyBC,IAAzB,EAA+BvB,EAA/B,EAAmC;AACxCuB,EAAAA,WAASA,OAAO,EAAhB;;AAEA,EAAA;;;;;;AAMA,EAAA,OAAKD,IAAL,GAAYA,IAAZ;;AAEArB,EAAAA,eAAMuB,MAAN,CAAa,IAAb,EAAmBD,IAAnB;;AAEA,EAAA;;;;;;AAMA,EAAA,OAAKvB,EAAL,GAAUA,EAAV;AACD,EAAA;;AAED,EAAA,IAAMyB,WAAW;AACf,EAAA;;;;;;;AAOAC,EAAAA,SAAO,KARQ;;AAUf,EAAA;;;;;;;AAOAC,EAAAA,OAAK;AAjBU,EAAA,CAAjB;;AAoBA,EAAA;;;;;;;;;;;AAWA,EAAO,SAASC,OAAT,CAAkB/B,IAAlB,EAAwB;AAC7BI,EAAAA,eAAM4B,cAAN,CAAqB,IAArB,EAA2BD,OAA3B;AACAE,EAAAA,mBAAUC,IAAV,CAAe,IAAf,EAAqBlC,IAArB;AACAA,EAAAA,WAASA,OAAO,EAAhB;AACAI,EAAAA,eAAMuB,MAAN,CAAa3B,IAAb,EAAmB4B,QAAnB;AACAxB,EAAAA,eAAMuB,MAAN,CAAa,IAAb,EAAmB3B,IAAnB;AACD,EAAA;;AAEDiC,mBAAUE,MAAV,CAAiB;AACfC,EAAAA,eAAaL,OADE;;AAGf,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAM,EAAAA,cAAY/B,KAxBG;;AA0Bf,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAgC,EAAAA,eAAahC,KA/CE;;AAiDf,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAiC,EAAAA,mBAAiBjC,KAtEF;;AAwEf,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAkC,EAAAA,gBAAclC,KA7FC;;AA+Ff,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAmC,EAAAA,mBAAiBnC,KApHF;;AAsHf,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAoC,EAAAA,aAAWpC,KA3II;;AA6If,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAqC,EAAAA,gBAAcrC,KAlKC;;AAoKf,EAAA;;;;;;;;;;;;;;;;;;;;;;AAsBAsC,EAAAA,YAAUtC,KA1LK;;AA4Lf,EAAA;;;;;;;;;;;;;;;;;;;;;;AAsBAuC,EAAAA,eAAavC,KAlNE;;AAoNf,EAAA;;;;;;;;;;;;;;;;;;;;;;AAsBAwC,EAAAA,kBAAgBxC,KA1OD;;AA4Of,EAAA;;;;;;;;;;;;;;;;;;;;;AAqBAyC,EAAAA,mBAAiBzC,KAjQF;;AAmQf,EAAA;;;;;;;;;;;;;;;;AAgBA0C,EAAAA,eAAalD,IAnRE;;AAqRf,EAAA;;;;;;;;;;;;;;;;;;AAkBAmD,EAAAA,gBAAcnD,IAvSC;;AAySf,EAAA;;;;;;;;;;;;;;;;;;AAkBAoD,EAAAA,oBAAkBpD,IA3TH;;AA6Tf,EAAA;;;;;;;;;;;;;;;;AAgBAqD,EAAAA,iBAAerD,IA7UA;;AA+Uf,EAAA;;;;;;;;;;;;;;;;AAgBAsD,EAAAA,oBAAkBtD,IA/VH;;AAiWf,EAAA;;;;;;;;;;;;;;;;AAgBAuD,EAAAA,cAAYvD,IAjXG;;AAmXf,EAAA;;;;;;;;;;;;;;;;AAgBAwD,EAAAA,iBAAexD,IAnYA;;AAqYf,EAAA;;;;;;;;;;;;;;;;AAgBAyD,EAAAA,aAAWzD,IArZI;;AAuZf,EAAA;;;;;;;;;;;;;;;;;;;AAmBA0D,EAAAA,gBAAc1D,IA1aC;;AA4af,EAAA;;;;;;;;;;;;;;;;;;;AAmBA2D,EAAAA,mBAAiB3D,IA/bF;;AAicf,EAAA;;;;;;;;;;;;;;;;;;AAkBA4D,EAAAA,oBAAkB5D,IAndH;;AAqdf,EAAA;;;;;;;;;;;;;;;;;;;AAmBA6D,EAAAA,OAxee,iBAweR5C,MAxeQ,EAweA6C,KAxeA,EAweO5D,IAxeP,EAwea;AAAA,EAAA;;AAC1B,EAAA,QAAIG,WAAJ;AACAyD,EAAAA,cAAUA,QAAQ,EAAlB;AACA5D,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA;AACAG,EAAAA,SAAKH,KAAKG,EAAL,GAAU,aAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiB6C,KAAjB,EAAwB5D,IAAxB,CAAd,EACJ6D,IADI,CACC,YAAM;AACV,EAAA;AACA1D,EAAAA,WAAKH,KAAKG,EAAL,GAAU,OAAf;AACA,EAAA,YAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqB6C,KAArB,EAA4B5D,IAA5B;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,MAAKyD,MAAL,CAAY/C,MAAZ,EAAoB6C,KAApB,EAA2B5D,IAA3B,CAAd,CAAP;AACD,EAAA,KANI,EAOJ6D,IAPI,CAOC,UAACE,OAAD,EAAa;AAAA,EAAA,mCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBA,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B7D,EAA3B,CAAf;AACA8D,EAAAA,iBAAW,MAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,YAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,MAAKF,EAAL,EAASY,MAAT,EAAiB6C,KAAjB,EAAwB5D,IAAxB,EAA8BiE,QAA9B,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KAjBI,CAAP;AAkBD,EAAA,GAjgBc;;;AAmgBf,EAAA;;;;;;;;;;;;AAYAE,EAAAA,QA/gBe,kBA+gBPtD,MA/gBO,EA+gBCC,KA/gBD,EA+gBQhB,IA/gBR,EA+gBc;AAAA,EAAA;;AAC3B,EAAA,QAAIG,WAAJ;AACAa,EAAAA,cAAUA,QAAQ,EAAlB;AACAhB,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA;AACAG,EAAAA,SAAKH,KAAKG,EAAL,GAAU,cAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiBC,KAAjB,EAAwBhB,IAAxB,CAAd,EACJ6D,IADI,CACC,UAACS,MAAD,EAAY;AAChB,EAAA;AACAtD,EAAAA,cAAQsD,WAAWF,SAAX,GAAuBpD,KAAvB,GAA+BsD,MAAvC;AACAtD,EAAAA,cAAQF,iBAAiBC,MAAjB,EAAyBC,KAAzB,EAAgChB,IAAhC,CAAR;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,QAAf;AACA,EAAA,aAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqBC,KAArB,EAA4BhB,IAA5B;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,OAAKkE,OAAL,CAAaxD,MAAb,EAAqBC,KAArB,EAA4BhB,IAA5B,CAAd,CAAP;AACD,EAAA,KARI,EASJ6D,IATI,CASC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBA,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B,QAA3B,CAAf;AACAC,EAAAA,eAASO,OAAT,GAAmB/C,OAAO,CAAP,GAAW,CAA9B;AACAwC,EAAAA,iBAAW,OAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,aAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,OAAKF,EAAL,EAASY,MAAT,EAAiBC,KAAjB,EAAwBhB,IAAxB,EAA8BiE,QAA9B,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KApBI,CAAP;AAqBD,EAAA,GA3iBc;;;AA6iBf,EAAA;;;;;;;;;;;;AAYAM,EAAAA,YAzjBe,sBAyjBH1D,MAzjBG,EAyjBKC,KAzjBL,EAyjBYhB,IAzjBZ,EAyjBkB;AAAA,EAAA;;AAC/B,EAAA,QAAIG,WAAJ;AACAa,EAAAA,cAAUA,QAAQ,EAAlB;AACAhB,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA;AACAG,EAAAA,SAAKH,KAAKG,EAAL,GAAU,kBAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiBC,KAAjB,EAAwBhB,IAAxB,CAAd,EACJ6D,IADI,CACC,UAACS,MAAD,EAAY;AAChB,EAAA;AACAtD,EAAAA,cAAQsD,WAAWF,SAAX,GAAuBpD,KAAvB,GAA+BsD,MAAvC;AACAtD,EAAAA,cAAQA,MAAM0D,GAAN,CAAU,UAACC,MAAD;AAAA,EAAA,eAAY7D,iBAAiBC,MAAjB,EAAyB4D,MAAzB,EAAiC3E,IAAjC,CAAZ;AAAA,EAAA,OAAV,CAAR;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,YAAf;AACA,EAAA,aAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqBC,KAArB,EAA4BhB,IAA5B;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,OAAKuE,WAAL,CAAiB7D,MAAjB,EAAyBC,KAAzB,EAAgChB,IAAhC,CAAd,CAAP;AACD,EAAA,KARI,EASJ6D,IATI,CASC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBvC,EAAAA,eAASA,OAAO,EAAhB;AACAuC,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B,YAA3B,CAAf;AACAC,EAAAA,eAASO,OAAT,GAAmB/C,KAAKxB,MAAxB;AACAgE,EAAAA,iBAAW,OAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,iBAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,OAAKF,EAAL,EAASY,MAAT,EAAiBC,KAAjB,EAAwBhB,IAAxB,EAA8BiE,QAA9B,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KArBI,CAAP;AAsBD,EAAA,GAtlBc;;;AAwlBf,EAAA;;;;;;;;;;;;;AAaAU,EAAAA,SArmBe,mBAqmBN9D,MArmBM,EAqmBE+D,EArmBF,EAqmBM9E,IArmBN,EAqmBY;AAAA,EAAA;;AACzB,EAAA,QAAIG,WAAJ;AACAH,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA;AACAG,EAAAA,SAAKH,KAAKG,EAAL,GAAU,eAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiB+D,EAAjB,EAAqB9E,IAArB,CAAd,EACJ6D,IADI,CACC,YAAM;AACV1D,EAAAA,WAAKH,KAAKG,EAAL,GAAU,SAAf;AACA,EAAA,aAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqB+D,EAArB,EAAyB9E,IAAzB;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,OAAK0E,QAAL,CAAchE,MAAd,EAAsB+D,EAAtB,EAA0B9E,IAA1B,CAAd,CAAP;AACD,EAAA,KALI,EAMJ6D,IANI,CAMC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBA,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B,SAA3B,CAAf;AACAC,EAAAA,iBAAW,OAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,cAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,OAAKF,EAAL,EAASY,MAAT,EAAiB+D,EAAjB,EAAqB9E,IAArB,EAA2BiE,QAA3B,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KAhBI,CAAP;AAiBD,EAAA,GA5nBc;;;AA8nBf,EAAA;;;;;;;;;;;;;;;;;;;AAmBAa,EAAAA,YAjpBe,sBAipBHjE,MAjpBG,EAipBK6C,KAjpBL,EAipBY5D,IAjpBZ,EAipBkB;AAAA,EAAA;;AAC/B,EAAA,QAAIG,WAAJ;AACAyD,EAAAA,cAAUA,QAAQ,EAAlB;AACA5D,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA;AACAG,EAAAA,SAAKH,KAAKG,EAAL,GAAU,kBAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiB6C,KAAjB,EAAwB5D,IAAxB,CAAd,EACJ6D,IADI,CACC,YAAM;AACV1D,EAAAA,WAAKH,KAAKG,EAAL,GAAU,YAAf;AACA,EAAA,aAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqB6C,KAArB,EAA4B5D,IAA5B;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,OAAK4E,WAAL,CAAiBlE,MAAjB,EAAyB6C,KAAzB,EAAgC5D,IAAhC,CAAd,CAAP;AACD,EAAA,KALI,EAMJ6D,IANI,CAMC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBA,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B,YAA3B,CAAf;AACAC,EAAAA,iBAAW,OAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,iBAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,OAAKF,EAAL,EAASY,MAAT,EAAiB6C,KAAjB,EAAwB5D,IAAxB,EAA8BiE,QAA9B,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KAhBI,CAAP;AAiBD,EAAA,GAzqBc;;;AA2qBf,EAAA;;;;;;;;;AASAe,EAAAA,eAprBe,yBAorBAnE,MAprBA,EAorBQoE,GAprBR,EAorBaC,OAprBb,EAorBsBC,MAprBtB,EAorB8B;AAAA,EAAA;;AAC3C,EAAA,QAAMC,cAAcH,IAAII,WAAJ,EAApB;;AAEA,EAAA,QAAInF,aAAMoF,QAAN,CAAeJ,OAAf,KAA2B,CAAChF,aAAMqF,OAAN,CAAcL,OAAd,CAAhC,EAAwD;AAAA,EAAA;AACtD,EAAA,YAAMT,SAASS,OAAf;AACA,EAAA;AAAA,EAAA,aAAO,OAAKM,IAAL,CAAUJ,WAAV,EAAuB,OAAKK,uBAAL,CAA6B5E,MAA7B,EAAqCoE,GAArC,EAA0CR,MAA1C,CAAvB,EAA0EU,MAA1E,EACJxB,IADI,CACC,UAAC+B,WAAD,EAAiB;AACrBT,EAAAA,gBAAIU,aAAJ,CAAkBlB,MAAlB,EAA0BiB,WAA1B;AACD,EAAA,WAHI;AAAP,EAAA;AAFsD,EAAA;;AAAA,EAAA;AAMvD,EAAA,KAND,MAMO;AACL,EAAA,UAAME,OAAOV,QACVV,GADU,CACN,UAACC,MAAD;AAAA,EAAA,eAAY,OAAKgB,uBAAL,CAA6B5E,MAA7B,EAAqCoE,GAArC,EAA0CR,MAA1C,CAAZ;AAAA,EAAA,OADM,EAEVvD,MAFU,CAEH,UAAC2E,GAAD;AAAA,EAAA,eAASA,GAAT;AAAA,EAAA,OAFG,CAAb;AAGA,EAAA,aAAO,KAAKC,OAAL,CAAaV,WAAb,EAA0B;AAC/BW,EAAAA,kCACGX,YAAYY,WADf,EAC6B;AACzB,EAAA,gBAAMJ;AADmB,EAAA,SAD7B;AAD+B,EAAA,OAA1B,EAMJT,MANI,EAMIxB,IANJ,CAMS,UAACsC,YAAD,EAAkB;AAChCf,EAAAA,gBAAQzE,OAAR,CAAgB,UAACgE,MAAD,EAAY;AAC1BwB,EAAAA,uBAAaxF,OAAb,CAAqB,UAACiF,WAAD,EAAiB;AACpC,EAAA,gBAAIA,YAAYN,YAAYY,WAAxB,MAAyCvB,OAAOQ,IAAIiB,UAAX,CAA7C,EAAqE;AACnEjB,EAAAA,kBAAIU,aAAJ,CAAkBlB,MAAlB,EAA0BiB,WAA1B;AACD,EAAA;AACF,EAAA,WAJD;AAKD,EAAA,SAND;AAOD,EAAA,OAdM,CAAP;AAeD,EAAA;AACF,EAAA,GAjtBc;;;AAmtBf,EAAA;;;;;;;;;;;;;AAaAF,EAAAA,MAhuBe,gBAguBT3E,MAhuBS,EAguBD+D,EAhuBC,EAguBG9E,IAhuBH,EAguBS;AAAA,EAAA;;AACtB,EAAA,QAAI2E,eAAJ;AAAA,EAAA,QAAYxE,WAAZ;AACA,EAAA,QAAIuB,OAAO,EAAX;AACA1B,EAAAA,aAASA,OAAO,EAAhB;AACAA,EAAAA,SAAKiB,IAAL,KAAcjB,KAAKiB,IAAL,GAAY,EAA1B;;AAEA,EAAA;AACAd,EAAAA,SAAKH,KAAKG,EAAL,GAAU,YAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiB+D,EAAjB,EAAqB9E,IAArB,CAAd,EACJ6D,IADI,CACC,YAAM;AACV1D,EAAAA,WAAKH,KAAKG,EAAL,GAAU,MAAf;AACA,EAAA,aAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqB+D,EAArB,EAAyB9E,IAAzB;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,OAAKgG,KAAL,CAAWtF,MAAX,EAAmB+D,EAAnB,EAAuB9E,IAAvB,CAAd,CAAP;AACD,EAAA,KALI,EAMJ6D,IANI,CAMC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACMA,OADN;AAAA,EAAA,UACZuC,OADY;AAAA,EAAA,UACHC,KADG;;AAEjB,EAAA,UAAI,CAACD,OAAL,EAAc;AACZ,EAAA;AACD,EAAA;AACD3B,EAAAA,eAAS2B,OAAT;AACA5E,EAAAA,aAAO6E,KAAP;AACA,EAAA,UAAMC,QAAQ,EAAd;;AAEApG,EAAAA,mBAAMqG,eAAN,CAAsB1F,MAAtB,EAA8Bf,IAA9B,EAAoC,UAACmF,GAAD,EAAME,MAAN,EAAiB;AACnD,EAAA,YAAIqB,aAAJ;AACA,EAAA,YAAIvB,IAAIiB,UAAJ,KAAmBjB,IAAIwB,IAAJ,KAAa,QAAb,IAAyBxB,IAAIwB,IAAJ,KAAa,SAAzD,CAAJ,EAAyE;AACvE,EAAA,cAAIxB,IAAIwB,IAAJ,KAAa,QAAjB,EAA2B;AACzBD,EAAAA,mBAAO,OAAKE,UAAL,CAAgB7F,MAAhB,EAAwBoE,GAAxB,EAA6BR,MAA7B,EAAqCU,MAArC,CAAP;AACD,EAAA,WAFD,MAEO;AACLqB,EAAAA,mBAAO,OAAKG,WAAL,CAAiB9F,MAAjB,EAAyBoE,GAAzB,EAA8BR,MAA9B,EAAsCU,MAAtC,CAAP;AACD,EAAA;AACF,EAAA,SAND,MAMO,IAAIF,IAAIwB,IAAJ,KAAa,SAAb,IAA0BxB,IAAI2B,SAAlC,EAA6C;AAClDJ,EAAAA,iBAAO,OAAKK,oBAAL,CAA0BhG,MAA1B,EAAkCoE,GAAlC,EAAuCR,MAAvC,EAA+CU,MAA/C,CAAP;AACD,EAAA,SAFM,MAEA,IAAIF,IAAIwB,IAAJ,KAAa,SAAb,IAA0BxB,IAAI6B,WAAlC,EAA+C;AACpDN,EAAAA,iBAAO,OAAKO,sBAAL,CAA4BlG,MAA5B,EAAoCoE,GAApC,EAAyCR,MAAzC,EAAiDU,MAAjD,CAAP;AACD,EAAA,SAFM,MAEA,IAAIF,IAAIwB,IAAJ,KAAa,WAAjB,EAA8B;AACnCD,EAAAA,iBAAO,OAAKxB,aAAL,CAAmBnE,MAAnB,EAA2BoE,GAA3B,EAAgCR,MAAhC,EAAwCU,MAAxC,CAAP;AACD,EAAA;AACD,EAAA,YAAIqB,IAAJ,EAAU;AACRF,EAAAA,gBAAM3F,IAAN,CAAW6F,IAAX;AACD,EAAA;AACF,EAAA,OAlBD;;AAoBA,EAAA,aAAOtG,aAAM8G,OAAN,CAAcC,GAAd,CAAkBX,KAAlB,CAAP;AACD,EAAA,KApCI,EAqCJ3C,IArCI,CAqCC,YAAM;AACV,EAAA,UAAII,WAAW,IAAIzC,QAAJ,CAAamD,MAAb,EAAqBjD,IAArB,EAA2B,MAA3B,CAAf;AACAuC,EAAAA,eAASmD,KAAT,GAAiBzC,SAAS,CAAT,GAAa,CAA9B;AACAV,EAAAA,iBAAW,OAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,WAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,OAAKF,EAAL,EAASY,MAAT,EAAiB+D,EAAjB,EAAqB9E,IAArB,EAA2BiE,QAA3B,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KA9CI,CAAP;AA+CD,EAAA,GAvxBc;;;AAyxBf,EAAA;;;;;;;;;;;;;;;;;;;AAmBA6B,EAAAA,SA5yBe,mBA4yBNjF,MA5yBM,EA4yBE6C,KA5yBF,EA4yBS5D,IA5yBT,EA4yBe;AAAA,EAAA;;AAC5BA,EAAAA,aAASA,OAAO,EAAhB;AACAA,EAAAA,SAAKiB,IAAL,KAAcjB,KAAKiB,IAAL,GAAY,EAA1B;;AAEA,EAAA,QAAImE,UAAU,EAAd;AACA,EAAA,QAAI1D,OAAO,EAAX;AACA,EAAA,QAAIvB,WAAJ;AACA,EAAA,QAAMkH,aAAarH,KAAKsH,WAAxB;;AAEA,EAAA,QAAIlH,aAAMoF,QAAN,CAAe6B,UAAf,CAAJ,EAAgC;AAC9B,EAAA,UAAME,cAAcF,WAAWzD,KAAX,IAAoB,EAAxC;AACA,EAAA,UAAIyD,WAAWG,OAAf,EAAwB;AACtB5D,EAAAA,gBAAQ2D,WAAR;AACD,EAAA,OAFD,MAEO;AACLnH,EAAAA,qBAAMqH,UAAN,CAAiB7D,KAAjB,EAAwB2D,WAAxB;AACD,EAAA;AACF,EAAA;;AAED,EAAA;AACApH,EAAAA,SAAKH,KAAKG,EAAL,GAAU,eAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiB6C,KAAjB,EAAwB5D,IAAxB,CAAd,EACJ6D,IADI,CACC,YAAM;AACV1D,EAAAA,WAAKH,KAAKG,EAAL,GAAU,SAAf;AACA,EAAA,aAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqB6C,KAArB,EAA4B5D,IAA5B;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,OAAKqH,QAAL,CAAc3G,MAAd,EAAsB6C,KAAtB,EAA6B5D,IAA7B,CAAd,CAAP;AACD,EAAA,KALI,EAMJ6D,IANI,CAMC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACOA,OADP;AAAA,EAAA,UACZ4D,QADY;AAAA,EAAA,UACFpB,KADE;;AAEjBoB,EAAAA,mBAAaA,WAAW,EAAxB;AACAvC,EAAAA,gBAAUuC,QAAV;AACAjG,EAAAA,aAAO6E,KAAP;AACA,EAAA,UAAMC,QAAQ,EAAd;AACApG,EAAAA,mBAAMqG,eAAN,CAAsB1F,MAAtB,EAA8Bf,IAA9B,EAAoC,UAACmF,GAAD,EAAME,MAAN,EAAiB;AACnD,EAAA,YAAIqB,aAAJ;AACA,EAAA,YAAIvB,IAAIiB,UAAJ,KAAmBjB,IAAIwB,IAAJ,KAAa,QAAb,IAAyBxB,IAAIwB,IAAJ,KAAa,SAAzD,CAAJ,EAAyE;AACvE,EAAA,cAAIxB,IAAIwB,IAAJ,KAAa,SAAjB,EAA4B;AAC1BD,EAAAA,mBAAO,OAAKG,WAAL,CAAiB9F,MAAjB,EAAyBoE,GAAzB,EAA8BC,OAA9B,EAAuCC,MAAvC,CAAP;AACD,EAAA,WAFD,MAEO;AACLqB,EAAAA,mBAAO,OAAKE,UAAL,CAAgB7F,MAAhB,EAAwBoE,GAAxB,EAA6BC,OAA7B,EAAsCC,MAAtC,CAAP;AACD,EAAA;AACF,EAAA,SAND,MAMO,IAAIF,IAAIwB,IAAJ,KAAa,SAAb,IAA0BxB,IAAI2B,SAAlC,EAA6C;AAClDJ,EAAAA,iBAAO,OAAKK,oBAAL,CAA0BhG,MAA1B,EAAkCoE,GAAlC,EAAuCC,OAAvC,EAAgDC,MAAhD,CAAP;AACD,EAAA,SAFM,MAEA,IAAIF,IAAIwB,IAAJ,KAAa,SAAb,IAA0BxB,IAAI6B,WAAlC,EAA+C;AACpDN,EAAAA,iBAAO,OAAKO,sBAAL,CAA4BlG,MAA5B,EAAoCoE,GAApC,EAAyCC,OAAzC,EAAkDC,MAAlD,CAAP;AACD,EAAA,SAFM,MAEA,IAAIF,IAAIwB,IAAJ,KAAa,WAAjB,EAA8B;AACnCD,EAAAA,iBAAO,OAAKxB,aAAL,CAAmBnE,MAAnB,EAA2BoE,GAA3B,EAAgCC,OAAhC,EAAyCC,MAAzC,CAAP;AACD,EAAA;AACD,EAAA,YAAIqB,IAAJ,EAAU;AACRF,EAAAA,gBAAM3F,IAAN,CAAW6F,IAAX;AACD,EAAA;AACF,EAAA,OAlBD;AAmBA,EAAA,aAAOtG,aAAM8G,OAAN,CAAcC,GAAd,CAAkBX,KAAlB,CAAP;AACD,EAAA,KAhCI,EAiCJ3C,IAjCI,CAiCC,YAAM;AACV,EAAA,UAAII,WAAW,IAAIzC,QAAJ,CAAa4D,OAAb,EAAsB1D,IAAtB,EAA4B,SAA5B,CAAf;AACAuC,EAAAA,eAASmD,KAAT,GAAiBhC,QAAQnF,MAAzB;AACAgE,EAAAA,iBAAW,OAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,cAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,OAAKF,EAAL,EAASY,MAAT,EAAiB6C,KAAjB,EAAwB5D,IAAxB,EAA8BiE,QAA9B,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KA1CI,CAAP;AA2CD,EAAA,GA32Bc;;;AA62Bf,EAAA;;;;;;;;;;AAUAyD,EAAAA,QAv3Be,kBAu3BPC,GAv3BO,EAu3BF7H,IAv3BE,EAu3BI;AACjBA,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,WAAOA,KAAK6H,GAAL,MAAczD,SAAd,GAA0BhE,aAAM0H,SAAN,CAAgB,KAAKD,GAAL,CAAhB,CAA1B,GAAuDzH,aAAM0H,SAAN,CAAgB9H,KAAK6H,GAAL,CAAhB,CAA9D;AACD,EAAA,GA13Bc;;;AA43Bf,EAAA;;;;;;;;;AASAhB,EAAAA,aAr4Be,uBAq4BF9F,MAr4BE,EAq4BMoE,GAr4BN,EAq4BWC,OAr4BX,EAq4BoBC,MAr4BpB,EAq4B4B;AAAA,EAAA;;AACzC,EAAA,QAAI0C,WAAW,KAAf;;AAEA,EAAA,QAAI3H,aAAMoF,QAAN,CAAeJ,OAAf,KAA2B,CAAChF,aAAMqF,OAAN,CAAcL,OAAd,CAAhC,EAAwD;AACtD2C,EAAAA,iBAAW,IAAX;AACA3C,EAAAA,gBAAU,CAACA,OAAD,CAAV;AACD,EAAA;AACD,EAAA,QAAM4C,MAAM5C,QAAQV,GAAR,CAAY,UAACC,MAAD;AAAA,EAAA,aAAY,OAAKsD,qBAAL,CAA2BlH,MAA3B,EAAmCoE,GAAnC,EAAwCR,MAAxC,CAAZ;AAAA,EAAA,KAAZ,CAAZ;AACA,EAAA,QAAMf,QAAQ;AACZqC,EAAAA,aAAO;AADK,EAAA,KAAd;AAGA,EAAA,QAAMiC,WAAWtE,MAAMqC,KAAN,CAAYd,IAAIiB,UAAhB,IAA8B,EAA/C;AACA,EAAA,QAAI2B,QAAJ,EAAc;AACZ,EAAA;AACAG,EAAAA,eAAS,IAAT,IAAiBF,IAAI,CAAJ,CAAjB;AACD,EAAA,KAHD,MAGO;AACLE,EAAAA,eAAS,IAAT,IAAiBF,IAAI5G,MAAJ,CAAW,UAAC0D,EAAD;AAAA,EAAA,eAAQA,EAAR;AAAA,EAAA,OAAX,CAAjB;AACD,EAAA;AACD,EAAA,WAAO,KAAKkB,OAAL,CAAab,IAAII,WAAJ,EAAb,EAAgC3B,KAAhC,EAAuCyB,MAAvC,EAA+CxB,IAA/C,CAAoD,UAACsC,YAAD,EAAkB;AAC3Ef,EAAAA,cAAQzE,OAAR,CAAgB,UAACgE,MAAD,EAAY;AAC1B,EAAA,YAAIwD,WAAW,EAAf;AACA,EAAA;AACA,EAAA,YAAIJ,QAAJ,EAAc;AACZI,EAAAA,qBAAWhC,YAAX;AACD,EAAA,SAFD,MAEO;AACLA,EAAAA,uBAAaxF,OAAb,CAAqB,UAACiF,WAAD,EAAiB;AACpC,EAAA,gBAAIxF,aAAMgI,GAAN,CAAUxC,WAAV,EAAuBT,IAAIiB,UAA3B,MAA2CzB,OAAO5D,OAAOmF,WAAd,CAA/C,EAA2E;AACzEiC,EAAAA,uBAAStH,IAAT,CAAc+E,WAAd;AACD,EAAA;AACF,EAAA,WAJD;AAKD,EAAA;AACDT,EAAAA,YAAIU,aAAJ,CAAkBlB,MAAlB,EAA0BwD,QAA1B;AACD,EAAA,OAbD;AAcD,EAAA,KAfM,CAAP;AAgBD,EAAA,GAv6Bc;AAy6BfpB,EAAAA,sBAz6Be,gCAy6BOhG,MAz6BP,EAy6BeoE,GAz6Bf,EAy6BoBC,OAz6BpB,EAy6B6BC,MAz6B7B,EAy6BqC;AAAA,EAAA;;AAClD,EAAA,QAAIV,eAAJ;AACA,EAAA,QAAM0D,gBAAgBlD,IAAII,WAAJ,EAAtB;;AAEA,EAAA,QAAInF,aAAMoF,QAAN,CAAeJ,OAAf,KAA2B,CAAChF,aAAMqF,OAAN,CAAcL,OAAd,CAAhC,EAAwD;AACtDT,EAAAA,eAASS,OAAT;AACD,EAAA;;AAED,EAAA,QAAIT,MAAJ,EAAY;AACV,EAAA,aAAO,KAAKqB,OAAL,CAAaqC,aAAb,EAA4B;AACjCpC,EAAAA,kCACGoC,cAAcnC,WADjB,EAC+B;AAC3B,EAAA,gBAAM,KAAKoC,oBAAL,CAA0BvH,MAA1B,EAAkCoE,GAAlC,EAAuCR,MAAvC;AADqB,EAAA,SAD/B;AADiC,EAAA,OAA5B,EAMJU,MANI,EAMIxB,IANJ,CAMS,UAACsC,YAAD,EAAkB;AAChChB,EAAAA,YAAIU,aAAJ,CAAkBlB,MAAlB,EAA0BwB,YAA1B;AACD,EAAA,OARM,CAAP;AASD,EAAA,KAVD,MAUO;AAAA,EAAA;AACL,EAAA,YAAIW,YAAY,EAAhB;AACA1B,EAAAA,gBAAQzE,OAAR,CAAgB,UAACgE,MAAD,EAAY;AAC1BmC,EAAAA,sBAAYA,UAAUyB,MAAV,CAAiB,QAAKD,oBAAL,CAA0BvH,MAA1B,EAAkCoE,GAAlC,EAAuCR,MAAvC,CAAjB,CAAZ;AACD,EAAA,SAFD;AAGA,EAAA;AAAA,EAAA,aAAO,QAAKqB,OAAL,CAAaqC,aAAb,EAA4B;AACjCpC,EAAAA,sCACGoC,cAAcnC,WADjB,EAC+B;AAC3B,EAAA,oBAAM3F,OAAOuG,SAAP,EAAkB1F,MAAlB,CAAyB,UAACoH,CAAD;AAAA,EAAA,uBAAOA,CAAP;AAAA,EAAA,eAAzB;AADqB,EAAA,aAD/B;AADiC,EAAA,WAA5B,EAMJnD,MANI,EAMIxB,IANJ,CAMS,UAACsC,YAAD,EAAkB;AAChCf,EAAAA,oBAAQzE,OAAR,CAAgB,UAACC,IAAD,EAAU;AACxB,EAAA,kBAAIuH,WAAW,EAAf;AACA,EAAA,kBAAIM,WAAWrI,aAAMgI,GAAN,CAAUxH,IAAV,EAAgBuE,IAAI2B,SAApB,KAAkC,EAAjD;AACA2B,EAAAA,yBAAWrI,aAAMqF,OAAN,CAAcgD,QAAd,IAA0BA,QAA1B,GAAqCC,OAAO5C,IAAP,CAAY2C,QAAZ,CAAhD;AACAtC,EAAAA,2BAAaxF,OAAb,CAAqB,UAACiF,WAAD,EAAiB;AACpC,EAAA,oBAAI6C,YAAYA,SAASnH,OAAT,CAAiBsE,YAAYyC,cAAcnC,WAA1B,CAAjB,MAA6D,CAAC,CAA9E,EAAiF;AAC/EiC,EAAAA,2BAAStH,IAAT,CAAc+E,WAAd;AACD,EAAA;AACF,EAAA,eAJD;AAKAT,EAAAA,kBAAIU,aAAJ,CAAkBjF,IAAlB,EAAwBuH,QAAxB;AACD,EAAA,aAVD;AAWA,EAAA,mBAAOhC,YAAP;AACD,EAAA,WAnBM;AAAP,EAAA;AALK,EAAA;;AAAA,EAAA;AAyBN,EAAA;AACF,EAAA,GAr9Bc;AAu9Bfc,EAAAA,wBAv9Be,kCAu9BSlG,MAv9BT,EAu9BiBoE,GAv9BjB,EAu9BsBC,OAv9BtB,EAu9B+BC,MAv9B/B,EAu9BuC;AAAA,EAAA;;AACpD,EAAA,QAAMgD,gBAAgBlD,IAAII,WAAJ,EAAtB;AACA,EAAA,QAAMW,cAAcnF,OAAOmF,WAA3B;AACA,EAAA,QAAIvB,eAAJ;;AAEA,EAAA,QAAIvE,aAAMoF,QAAN,CAAeJ,OAAf,KAA2B,CAAChF,aAAMqF,OAAN,CAAcL,OAAd,CAAhC,EAAwD;AACtDT,EAAAA,eAASS,OAAT;AACD,EAAA;;AAED,EAAA,QAAIT,MAAJ,EAAY;AACV,EAAA,aAAO,KAAKqB,OAAL,CAAab,IAAII,WAAJ,EAAb,EAAgC;AACrCU,EAAAA,kCACGd,IAAI6B,WADP,EACqB;AACjB,EAAA,sBAAY,KAAK2B,sBAAL,CAA4B5H,MAA5B,EAAoCoE,GAApC,EAAyCR,MAAzC;AADK,EAAA,SADrB;AADqC,EAAA,OAAhC,EAMJU,MANI,EAMIxB,IANJ,CAMS,UAACsC,YAAD,EAAkB;AAChChB,EAAAA,YAAIU,aAAJ,CAAkBlB,MAAlB,EAA0BwB,YAA1B;AACD,EAAA,OARM,CAAP;AASD,EAAA,KAVD,MAUO;AACL,EAAA,aAAO,KAAKH,OAAL,CAAaqC,aAAb,EAA4B;AACjCpC,EAAAA,kCACGd,IAAI6B,WADP,EACqB;AACjB,EAAA,2BAAiB5B,QAAQV,GAAR,CAAY,UAACC,MAAD;AAAA,EAAA,mBAAY,QAAKgE,sBAAL,CAA4B5H,MAA5B,EAAoCoE,GAApC,EAAyCR,MAAzC,CAAZ;AAAA,EAAA,WAAZ;AADA,EAAA,SADrB;AADiC,EAAA,OAA5B,EAMJU,MANI,EAMIxB,IANJ,CAMS,UAACsC,YAAD,EAAkB;AAChC,EAAA,YAAMyC,mBAAmBzD,IAAI6B,WAA7B;AACA5B,EAAAA,gBAAQzE,OAAR,CAAgB,UAACgE,MAAD,EAAY;AAC1B,EAAA,cAAMkE,gBAAgB,EAAtB;AACA,EAAA,cAAM/D,KAAK1E,aAAMgI,GAAN,CAAUzD,MAAV,EAAkBuB,WAAlB,CAAX;AACAC,EAAAA,uBAAaxF,OAAb,CAAqB,UAACiF,WAAD,EAAiB;AACpC,EAAA,gBAAMoB,cAAc5G,aAAMgI,GAAN,CAAUjC,YAAV,EAAwByC,gBAAxB,KAA6C,EAAjE;AACA,EAAA,gBAAI5B,YAAY1F,OAAZ,CAAoBwD,EAApB,MAA4B,CAAC,CAAjC,EAAoC;AAClC+D,EAAAA,4BAAchI,IAAd,CAAmB+E,WAAnB;AACD,EAAA;AACF,EAAA,WALD;AAMAT,EAAAA,cAAIU,aAAJ,CAAkBlB,MAAlB,EAA0BkE,aAA1B;AACD,EAAA,SAVD;AAWD,EAAA,OAnBM,CAAP;AAoBD,EAAA;AACF,EAAA,GAhgCc;;;AAkgCf,EAAA;;;;;;;;;AASAjC,EAAAA,YA3gCe,sBA2gCH7F,MA3gCG,EA2gCKoE,GA3gCL,EA2gCUC,OA3gCV,EA2gCmBC,MA3gCnB,EA2gC2B;AACxC,EAAA,QAAIjF,aAAMoF,QAAN,CAAeJ,OAAf,KAA2B,CAAChF,aAAMqF,OAAN,CAAcL,OAAd,CAAhC,EAAwD;AACtDA,EAAAA,gBAAU,CAACA,OAAD,CAAV;AACD,EAAA;AACD,EAAA,WAAO,KAAKyB,WAAL,CAAiB9F,MAAjB,EAAyBoE,GAAzB,EAA8BC,OAA9B,EAAuCC,MAAvC,EAA+CxB,IAA/C,CAAoD,YAAM;AAC/DuB,EAAAA,cAAQzE,OAAR,CAAgB,UAACgE,MAAD,EAAY;AAC1B,EAAA,YAAMmE,cAAc3D,IAAI4D,aAAJ,CAAkBpE,MAAlB,CAApB;AACA,EAAA,YAAIvE,aAAMqF,OAAN,CAAcqD,WAAd,KAA8BA,YAAY7I,MAA9C,EAAsD;AACpDkF,EAAAA,cAAIU,aAAJ,CAAkBlB,MAAlB,EAA0BmE,YAAY,CAAZ,CAA1B;AACD,EAAA;AACF,EAAA,OALD;AAMD,EAAA,KAPM,CAAP;AAQD,EAAA,GAvhCc;;;AAyhCf,EAAA;;;;;;;;;;;;AAYAb,EAAAA,uBAriCe,iCAqiCQlH,MAriCR,EAqiCgBoE,GAriChB,EAqiCqBR,MAriCrB,EAqiC6B;AAC1C,EAAA,WAAOQ,IAAI6D,aAAJ,CAAkBrE,MAAlB,CAAP;AACD,EAAA,GAviCc;;;AAyiCf,EAAA;;;;;;;;;AASA2D,EAAAA,sBAljCe,gCAkjCOvH,MAljCP,EAkjCeoE,GAljCf,EAkjCoBR,MAljCpB,EAkjC4B;AACzC,EAAA,QAAImC,YAAY,EAAhB;AACA,EAAA,QAAI2B,WAAWrI,aAAMgI,GAAN,CAAUzD,MAAV,EAAkBQ,IAAI2B,SAAtB,KAAoC,EAAnD;AACA2B,EAAAA,eAAWrI,aAAMqF,OAAN,CAAcgD,QAAd,IAA0BA,QAA1B,GAAqCC,OAAO5C,IAAP,CAAY2C,QAAZ,CAAhD;AACA3B,EAAAA,gBAAYA,UAAUyB,MAAV,CAAiBE,QAAjB,CAAZ;AACA,EAAA,WAAOlI,OAAOuG,SAAP,EAAkB1F,MAAlB,CAAyB,UAACoH,CAAD;AAAA,EAAA,aAAOA,CAAP;AAAA,EAAA,KAAzB,CAAP;AACD,EAAA,GAxjCc;;;AA0jCf,EAAA;;;;;;;;;AASAG,EAAAA,wBAnkCe,kCAmkCS5H,MAnkCT,EAmkCiBoE,GAnkCjB,EAmkCsBR,MAnkCtB,EAmkC8B;AAC3C,EAAA,WAAOvE,aAAMgI,GAAN,CAAUzD,MAAV,EAAkB5D,OAAOmF,WAAzB,CAAP;AACD,EAAA,GArkCc;;;AAukCf,EAAA;;;;;;;;;AASAP,EAAAA,yBAhlCe,mCAglCU5E,MAhlCV,EAglCkBoE,GAhlClB,EAglCuBR,MAhlCvB,EAglC+B;AAC5C,EAAA,WAAOQ,IAAI6D,aAAJ,CAAkBrE,MAAlB,CAAP;AACD,EAAA,GAllCc;;;AAolCf,EAAA;;;;;;;;;;;;;;;;;;;;AAoBAsE,EAAAA,KAxmCe,eAwmCVlI,MAxmCU,EAwmCFmI,KAxmCE,EAwmCKtF,KAxmCL,EAwmCY5D,IAxmCZ,EAwmCkB;AAAA,EAAA;;AAC/B,EAAA,QAAIG,WAAJ;AACA,EAAA,QAAI,CAACC,aAAM+I,QAAN,CAAeD,KAAf,CAAL,EAA4B;AAC1B,EAAA,YAAM,IAAIE,KAAJ,CAAU,yBAAV,CAAN;AACD,EAAA;AACDxF,EAAAA,cAAUA,QAAQ,EAAlB;AACA5D,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA;AACAG,EAAAA,SAAKH,KAAKG,EAAL,GAAU,WAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiBmI,KAAjB,EAAwBtF,KAAxB,EAA+B5D,IAA/B,CAAd,EACJ6D,IADI,CACC,YAAM;AACV,EAAA;AACA1D,EAAAA,WAAKH,KAAKG,EAAL,GAAU,KAAf;AACA,EAAA,cAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqBmI,KAArB,EAA4BtF,KAA5B,EAAmC5D,IAAnC;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,QAAKgJ,IAAL,CAAUtI,MAAV,EAAkBmI,KAAlB,EAAyBtF,KAAzB,EAAgC5D,IAAhC,CAAd,CAAP;AACD,EAAA,KANI,EAOJ6D,IAPI,CAOC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBA,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B7D,EAA3B,CAAf;AACA8D,EAAAA,iBAAW,QAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,UAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,QAAKF,EAAL,EAASY,MAAT,EAAiBmI,KAAjB,EAAwBtF,KAAxB,EAA+B5D,IAA/B,EAAqCiE,QAArC,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KAjBI,CAAP;AAkBD,EAAA,GApoCc;;;AAsoCf,EAAA;;;;;;;;AAQAD,EAAAA,SA9oCe,mBA8oCND,QA9oCM,EA8oCIjE,IA9oCJ,EA8oCU;AACvB,EAAA,WAAO,KAAK4H,MAAL,CAAY,KAAZ,EAAmB5H,IAAnB,IAA2BiE,QAA3B,GAAsCA,SAASxC,IAAtD;AACD,EAAA,GAhpCc;;;AAkpCf,EAAA;;;;;;;;;;;;;;AAcA6H,EAAAA,QAhqCe,kBAgqCPvI,MAhqCO,EAgqCC+D,EAhqCD,EAgqCK9D,KAhqCL,EAgqCYhB,IAhqCZ,EAgqCkB;AAAA,EAAA;;AAC/BgB,EAAAA,cAAUA,QAAQ,EAAlB;AACAhB,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,QAAIG,WAAJ;;AAEA,EAAA;AACAA,EAAAA,SAAKH,KAAKG,EAAL,GAAU,cAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiB+D,EAAjB,EAAqB9D,KAArB,EAA4BhB,IAA5B,CAAd,EACJ6D,IADI,CACC,UAACS,MAAD,EAAY;AAChB,EAAA;AACAtD,EAAAA,cAAQsD,WAAWF,SAAX,GAAuBpD,KAAvB,GAA+BsD,MAAvC;AACAtD,EAAAA,cAAQF,iBAAiBC,MAAjB,EAAyBC,KAAzB,EAAgChB,IAAhC,CAAR;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,QAAf;AACA,EAAA,cAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqB+D,EAArB,EAAyB9D,KAAzB,EAAgChB,IAAhC;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,QAAKkJ,OAAL,CAAaxI,MAAb,EAAqB+D,EAArB,EAAyB9D,KAAzB,EAAgChB,IAAhC,CAAd,CAAP;AACD,EAAA,KARI,EASJ6D,IATI,CASC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBA,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B,QAA3B,CAAf;AACAC,EAAAA,eAASuF,OAAT,GAAmB/H,OAAO,CAAP,GAAW,CAA9B;AACAwC,EAAAA,iBAAW,QAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,aAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,QAAKF,EAAL,EAASY,MAAT,EAAiB+D,EAAjB,EAAqB9D,KAArB,EAA4BhB,IAA5B,EAAkCiE,QAAlC,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KApBI,CAAP;AAqBD,EAAA,GA5rCc;;;AA8rCf,EAAA;;;;;;;;;;;;;;;;;;;;AAoBAsF,EAAAA,WAltCe,qBAktCJ1I,MAltCI,EAktCIC,KAltCJ,EAktCW4C,KAltCX,EAktCkB5D,IAltClB,EAktCwB;AAAA,EAAA;;AACrCgB,EAAAA,cAAUA,QAAQ,EAAlB;AACA4C,EAAAA,cAAUA,QAAQ,EAAlB;AACA5D,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,QAAIG,WAAJ;;AAEA,EAAA;AACAA,EAAAA,SAAKH,KAAKG,EAAL,GAAU,iBAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiBC,KAAjB,EAAwB4C,KAAxB,EAA+B5D,IAA/B,CAAd,EACJ6D,IADI,CACC,UAACS,MAAD,EAAY;AAChB,EAAA;AACAtD,EAAAA,cAAQsD,WAAWF,SAAX,GAAuBpD,KAAvB,GAA+BsD,MAAvC;AACAtD,EAAAA,cAAQF,iBAAiBC,MAAjB,EAAyBC,KAAzB,EAAgChB,IAAhC,CAAR;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,WAAf;AACA,EAAA,cAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqBC,KAArB,EAA4B4C,KAA5B,EAAmC5D,IAAnC;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,QAAKqJ,UAAL,CAAgB3I,MAAhB,EAAwBC,KAAxB,EAA+B4C,KAA/B,EAAsC5D,IAAtC,CAAd,CAAP;AACD,EAAA,KARI,EASJ6D,IATI,CASC,UAACE,OAAD,EAAa;AAAA,EAAA,qCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBvC,EAAAA,eAASA,OAAO,EAAhB;AACAuC,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B,WAA3B,CAAf;AACAC,EAAAA,eAASuF,OAAT,GAAmB/H,KAAKxB,MAAxB;AACAgE,EAAAA,iBAAW,QAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,gBAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,QAAKF,EAAL,EAASY,MAAT,EAAiBC,KAAjB,EAAwB4C,KAAxB,EAA+B5D,IAA/B,EAAqCiE,QAArC,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KArBI,CAAP;AAsBD,EAAA,GAhvCc;;;AAkvCf,EAAA;;;;;;;;;;;;AAYAwF,EAAAA,YA9vCe,sBA8vCH5I,MA9vCG,EA8vCKqE,OA9vCL,EA8vCcpF,IA9vCd,EA8vCoB;AAAA,EAAA;;AACjCoF,EAAAA,gBAAYA,UAAU,EAAtB;AACApF,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,QAAIG,WAAJ;AACA,EAAA,QAAM+F,cAAcnF,OAAOmF,WAA3B;;AAEAd,EAAAA,cAAUA,QAAQhE,MAAR,CAAe,UAACuD,MAAD;AAAA,EAAA,aAAYvE,aAAMgI,GAAN,CAAUzD,MAAV,EAAkBuB,WAAlB,CAAZ;AAAA,EAAA,KAAf,CAAV;;AAEA,EAAA;AACA/F,EAAAA,SAAKH,KAAKG,EAAL,GAAU,kBAAf;AACA,EAAA,WAAOC,aAAMC,OAAN,CAAc,KAAKF,EAAL,EAASY,MAAT,EAAiBqE,OAAjB,EAA0BpF,IAA1B,CAAd,EACJ6D,IADI,CACC,UAAC8D,QAAD,EAAc;AAClB,EAAA;AACAvC,EAAAA,gBAAUuC,aAAavD,SAAb,GAAyBgB,OAAzB,GAAmCuC,QAA7C;AACAvC,EAAAA,gBAAUA,QAAQV,GAAR,CAAY,UAACC,MAAD;AAAA,EAAA,eAAY7D,iBAAiBC,MAAjB,EAAyB4D,MAAzB,EAAiC3E,IAAjC,CAAZ;AAAA,EAAA,OAAZ,CAAV;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,YAAf;AACA,EAAA,cAAKD,GAAL,CAASC,EAAT,EAAaY,MAAb,EAAqBqE,OAArB,EAA8BpF,IAA9B;AACA,EAAA,aAAOI,aAAMC,OAAN,CAAc,QAAKuJ,WAAL,CAAiB7I,MAAjB,EAAyBqE,OAAzB,EAAkCpF,IAAlC,CAAd,CAAP;AACD,EAAA,KARI,EASJ6D,IATI,CASC,UAACE,OAAD,EAAa;AAAA,EAAA,qCACIA,OADJ;AAAA,EAAA,UACZtC,IADY;AAAA,EAAA,UACNuC,MADM;;AAEjBvC,EAAAA,eAASA,OAAO,EAAhB;AACAuC,EAAAA,iBAAWA,SAAS,EAApB;AACA,EAAA,UAAIC,WAAW,IAAIzC,QAAJ,CAAaC,IAAb,EAAmBuC,MAAnB,EAA2B,YAA3B,CAAf;AACAC,EAAAA,eAASuF,OAAT,GAAmB/H,KAAKxB,MAAxB;AACAgE,EAAAA,iBAAW,QAAKC,OAAL,CAAaD,QAAb,EAAuBjE,IAAvB,CAAX;;AAEA,EAAA;AACAG,EAAAA,WAAKH,KAAKG,EAAL,GAAU,iBAAf;AACA,EAAA,aAAOC,aAAMC,OAAN,CAAc,QAAKF,EAAL,EAASY,MAAT,EAAiBqE,OAAjB,EAA0BpF,IAA1B,EAAgCiE,QAAhC,CAAd,EACJJ,IADI,CACC,UAACM,SAAD;AAAA,EAAA,eAAeA,cAAcC,SAAd,GAA0BH,QAA1B,GAAqCE,SAApD;AAAA,EAAA,OADD,CAAP;AAED,EAAA,KArBI,CAAP;AAsBD,EAAA;AA9xCc,EAAA,CAAjB;;EC7FA,IAAI0F,QAAQ,EAAZ;AACA,EAAA,IAAIC,gBAAgB,KAApB;;AAEA,EAAA,SAASC,OAAT,CAAkBrD,IAAlB,EAAwB;AACtBmD,EAAAA,QAAMhJ,IAAN,CAAW6F,IAAX;AACD,EAAA;;AAED,EAAA,SAASsD,OAAT,GAAoB;AAClB,EAAA,MAAIH,MAAM5J,MAAN,IAAgB,CAAC6J,aAArB,EAAoC;AAClCA,EAAAA,oBAAgB,IAAhB;AACAD,EAAAA,UAAM,CAAN;AACD,EAAA;AACF,EAAA;;AAED,EAAA,SAASI,SAAT,CAAoBvD,IAApB,EAA0B;AACxB,EAAA,MAAI,CAACmD,MAAM5J,MAAX,EAAmB;AACjB8J,EAAAA,YAAQrD,IAAR;AACAsD,EAAAA;AACD,EAAA,GAHD,MAGO;AACLD,EAAAA,YAAQrD,IAAR;AACD,EAAA;AACF,EAAA;;AAED,EAAA,SAASwD,UAAT,CAAqBC,EAArB,EAAyB;AACvB,EAAA,SAAO,IAAI/J,aAAM8G,OAAV,CAAkBiD,EAAlB,EAAsBtG,IAAtB,CAA2B,UAACG,MAAD,EAAY;AAC5C8F,EAAAA,oBAAgB,KAAhB;AACAD,EAAAA,UAAMO,KAAN;AACAC,EAAAA,eAAWL,OAAX,EAAoB,CAApB;AACA,EAAA,WAAOhG,MAAP;AACD,EAAA,GALM,EAKJ,UAACsG,GAAD,EAAS;AACVR,EAAAA,oBAAgB,KAAhB;AACAD,EAAAA,UAAMO,KAAN;AACAC,EAAAA,eAAWL,OAAX,EAAoB,CAApB;AACA,EAAA,WAAO5J,aAAMmK,MAAN,CAAaD,GAAb,CAAP;AACD,EAAA,GAVM,CAAP;AAWD,EAAA;;AAED,EAAA,IAAME,YAAYzI,QAAQ0I,SAA1B;;AAEA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,EAAO,SAASC,eAAT,CAA0B1K,IAA1B,EAAgC;AACrCI,EAAAA,eAAM4B,cAAN,CAAqB,IAArB,EAA2B0I,eAA3B;AACA1K,EAAAA,WAASA,OAAO,EAAhB;AACA+B,EAAAA,UAAQG,IAAR,CAAa,IAAb,EAAmBlC,IAAnB;;AAEA,EAAA;;;;;;;AAOA,EAAA,MAAIA,KAAK2K,EAAT,EAAa;AACX,EAAA,SAAKA,EAAL,GAAU3K,KAAK2K,EAAL,IAAWC,SAASC,QAAT,EAArB;AACD,EAAA;AACF,EAAA;;AAED,EAAA;AACAH,EAAAA,gBAAgBD,SAAhB,GAA4B/B,OAAOrE,MAAP,CAActC,QAAQ0I,SAAtB,EAAiC;AAC3DrI,EAAAA,eAAa;AACXf,EAAAA,WAAOqJ,eADI;AAEXI,EAAAA,gBAAY,KAFD;AAGXC,EAAAA,cAAU,IAHC;AAIXC,EAAAA,kBAAc;AAJH,EAAA;AAD8C,EAAA,CAAjC,CAA5B;;AASAtC,EAAAA,OAAOuC,cAAP,CAAsBP,eAAtB,EAAuC,WAAvC,EAAoD;AAClDM,EAAAA,gBAAc,IADoC;AAElD3J,EAAAA,SAAOU;AAF2C,EAAA,CAApD;;AAKA,EAAA;;;;;;;;;;;;;;;;;;;;;;AAsBA2I,EAAAA,gBAAgBvI,MAAhB,GAAyB/B,aAAM+B,MAA/B;;AAEA/B,eAAM8K,sBAAN,CAA6BR,gBAAgBD,SAA7C,EAAwD;AACtD,EAAA;;;;;;;;;;;;AAYA3G,EAAAA,QAbsD,kBAa9C/C,MAb8C,EAatC6C,KAbsC,EAa/B5D,IAb+B,EAazB;AAC3B4D,EAAAA,cAAUA,QAAQ,EAAlB;AACA5D,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,WAAO,KAAK0H,QAAL,CAAc3G,MAAd,EAAsB6C,KAAtB,EAA6B5D,IAA7B,EAAmC6D,IAAnC,CAAwC,UAACG,MAAD,EAAY;AACzDA,EAAAA,aAAO,CAAP,IAAYA,OAAO,CAAP,EAAU/D,MAAtB;AACA,EAAA,aAAO+D,MAAP;AACD,EAAA,KAHM,CAAP;AAID,EAAA,GApBqD;;;AAsBtD,EAAA;;;;;;;;;;;AAWAO,EAAAA,SAjCsD,mBAiC7CxD,MAjC6C,EAiCrCC,KAjCqC,EAiC9BhB,IAjC8B,EAiCxB;AAC5BgB,EAAAA,cAAUA,QAAQ,EAAlB;AACAhB,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,WAAO,KAAKmL,OAAL,CAAapK,MAAb,EAAqBC,KAArB,EAA4BhB,IAA5B,CAAP;AACD,EAAA,GArCqD;AAuCtDmL,EAAAA,SAvCsD,mBAuC7CpK,MAvC6C,EAuCrCC,KAvCqC,EAuC9BhB,IAvC8B,EAuCxB;AAAA,EAAA;;AAC5B,EAAA,QAAMsE,SAASlE,aAAM0H,SAAN,CAAgB9G,KAAhB,CAAf;AACAhB,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA,QAAM8E,KAAK1E,aAAMgI,GAAN,CAAU9D,MAAV,EAAkBvD,OAAOmF,WAAzB,CAAX;AACA,EAAA,QAAMkF,gBAAgB,KAAKC,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,CAAtB;;AAEA,EAAA,QAAIsL,gBAAJ;;AAEA,EAAA,QAAIlL,aAAMmL,MAAN,CAAazG,EAAb,CAAJ,EAAsB;AACpBwG,EAAAA,gBAAUF,cAAcI,KAAd,CAAoB1G,EAApB,CAAV;AACD,EAAA,KAFD,MAEO;AACLwG,EAAAA,gBAAUF,cAAcvK,IAAd,EAAV;AACAT,EAAAA,mBAAMqL,GAAN,CAAUnH,MAAV,EAAkBvD,OAAOmF,WAAzB,EAAsCoF,QAAQvF,GAA9C;AACD,EAAA;;AAED,EAAA,WAAOuF,QAAQG,GAAR,CAAYnH,MAAZ,EACJT,IADI,CACC;AAAA,EAAA,aAAM,MAAK6H,KAAL,CAAWJ,OAAX,CAAN;AAAA,EAAA,KADD,EAEJzH,IAFI,CAEC,UAACc,MAAD,EAAY;AAChB,EAAA,UAAI,CAACA,MAAL,EAAa;AACX,EAAA,cAAM,IAAIyE,KAAJ,CAAU,WAAV,CAAN;AACD,EAAA;AACD,EAAA,aAAO,CAACzE,MAAD,EAAS,EAAEgH,KAAKL,OAAP,EAAT,CAAP;AACD,EAAA,KAPI,CAAP;AAQD,EAAA,GA/DqD;AAiEtDM,EAAAA,cAjEsD,wBAiExC7K,MAjEwC,EAiEhCqE,OAjEgC,EAiEvBpF,IAjEuB,EAiEjB;AAAA,EAAA;;AACnCA,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA,QAAMkG,cAAcnF,OAAOmF,WAA3B;AACA,EAAA,QAAM2F,qBAAqB,EAA3B;AACA,EAAA,QAAMT,gBAAgB,KAAKC,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,CAAtB;;AAEA,EAAA;AACAoF,EAAAA,YAAQzE,OAAR,CAAgB,UAACgE,MAAD,EAAY;AAC1B,EAAA,UAAMG,KAAK1E,aAAMgI,GAAN,CAAUzD,MAAV,EAAkBuB,WAAlB,CAAX;AACA,EAAA,UAAI5B,SAASlE,aAAM0H,SAAN,CAAgBnD,MAAhB,CAAb;AACA,EAAA,UAAI2G,gBAAJ;;AAEA,EAAA,UAAIlL,aAAMmL,MAAN,CAAazG,EAAb,CAAJ,EAAsB;AACpBwG,EAAAA,kBAAUF,cAAcI,KAAd,CAAoB1G,EAApB,CAAV;AACD,EAAA,OAFD,MAEO;AACLwG,EAAAA,kBAAUF,cAAcvK,IAAd,EAAV;AACAT,EAAAA,qBAAMqL,GAAN,CAAUnH,MAAV,EAAkB4B,WAAlB,EAA+BoF,QAAQvF,GAAvC;AACD,EAAA;AACD8F,EAAAA,yBAAmBhL,IAAnB,CAAwB,EAAE8K,KAAKL,OAAP,EAAgBtK,OAAOsD,MAAvB,EAAxB;AACD,EAAA,KAZD;;AAcA,EAAA,WAAO,KAAKwH,aAAL,CAAmB/K,MAAnB,EAA2B8K,kBAA3B,EAA+C7L,IAA/C,EACJ6D,IADI,CACC,YAAM;AACV,EAAA;AACA,EAAA,aAAOzD,aAAM8G,OAAN,CAAcC,GAAd,CAAkB0E,mBAAmBnH,GAAnB,CAAuB,UAAC9D,IAAD;AAAA,EAAA,eAAU,OAAK8K,KAAL,CAAW9K,KAAK+K,GAAhB,CAAV;AAAA,EAAA,OAAvB,CAAlB,CAAP;AACD,EAAA,KAJI,EAKJ9H,IALI,CAKC,UAACuB,OAAD,EAAa;AACjB,EAAA;AACA,EAAA,aAAO,CAACA,OAAD,EAAU,EAAEuG,KAAKE,mBAAmBnH,GAAnB,CAAuB,UAAC9D,IAAD;AAAA,EAAA,iBAAUA,KAAK+K,GAAf;AAAA,EAAA,SAAvB,CAAP,EAAV,CAAP;AACD,EAAA,KARI,CAAP;AASD,EAAA,GAhGqD;AAkGtDD,EAAAA,OAlGsD,iBAkG/CC,GAlG+C,EAkG1C;AACV,EAAA,WAAOA,IAAII,IAAJ,CAAS,OAAT,EAAkBlI,IAAlB,CAAuB,UAACmI,YAAD,EAAkB;AAC9C,EAAA,UAAI,CAACA,aAAaC,MAAb,EAAL,EAA4B;AAC1B,EAAA,eAAO,IAAP;AACD,EAAA;AACD,EAAA,aAAOD,aAAaE,GAAb,EAAP;AACD,EAAA,KALM,CAAP;AAMD,EAAA,GAzGqD;AA2GtDJ,EAAAA,eA3GsD,yBA2GvC/K,MA3GuC,EA2G/B8K,kBA3G+B,EA2GX7L,IA3GW,EA2GL;AAAA,EAAA;;AAAE,EAAA;AACjD,EAAA;AACA,EAAA;AACA,EAAA,QAAImM,eAAe,EAAnB;AACAN,EAAAA,uBAAmBlL,OAAnB,CAA2B,UAACC,IAAD,EAAU;AACnCuL,EAAAA,mBAAavL,KAAK+K,GAAL,CAASS,QAAT,GAAoB5E,OAApB,CAA4B,OAAK6D,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,EAA0BoM,QAA1B,EAA5B,EAAkE,EAAlE,CAAb,IAAsFxL,KAAKI,KAA3F;AACD,EAAA,KAFD;AAGA,EAAA,WAAO,KAAKqK,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,EAA0BsJ,MAA1B,CAAiC6C,YAAjC,CAAP;AACD,EAAA,GAnHqD;;;AAqHtD,EAAA;;;;;;;;;;;;AAYAvH,EAAAA,aAjIsD,uBAiIzC7D,MAjIyC,EAiIjCqE,OAjIiC,EAiIxBpF,IAjIwB,EAiIlB;AAClCA,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,WAAO,KAAK4L,YAAL,CAAkB7K,MAAlB,EAA0BqE,OAA1B,EAAmCpF,IAAnC,CAAP;AACD,EAAA,GApIqD;;;AAsItD,EAAA;;;;;;;;;;;;AAYA+E,EAAAA,UAlJsD,oBAkJ5ChE,MAlJ4C,EAkJpC+D,EAlJoC,EAkJhC9E,IAlJgC,EAkJ1B;AAC1BA,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,QAAM2L,MAAM,KAAKN,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,EAA0BwL,KAA1B,CAAgC1G,EAAhC,CAAZ;AACA,EAAA,WAAO6G,IAAIU,MAAJ,GAAaxI,IAAb,CAAkB;AAAA,EAAA,aAAM,CAACO,SAAD,EAAY,EAAEuH,QAAF,EAAZ,CAAN;AAAA,EAAA,KAAlB,CAAP;AACD,EAAA,GAtJqD;;;AAwJtD,EAAA;;;;;;;;;;;;AAYA1G,EAAAA,aApKsD,uBAoKzClE,MApKyC,EAoKjC6C,KApKiC,EAoK1B5D,IApK0B,EAoKpB;AAAA,EAAA;;AAChC4D,EAAAA,cAAUA,QAAQ,EAAlB;AACA5D,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA,WAAO,KAAK0H,QAAL,CAAc3G,MAAd,EAAsB6C,KAAtB,EACJC,IADI,CACC,UAACE,OAAD,EAAa;AAAA,EAAA,mCACCA,OADD;AAAA,EAAA,UACVqB,OADU;;AAEjB,EAAA,UAAMc,cAAcnF,OAAOmF,WAA3B;AACA,EAAA,aAAO9F,aAAM8G,OAAN,CAAcC,GAAd,CAAkB/B,QAAQV,GAAR,CAAY,UAACC,MAAD,EAAY;AAC/C,EAAA,eAAO,OAAKI,QAAL,CAAchE,MAAd,EAAsBX,aAAMgI,GAAN,CAAUzD,MAAV,EAAkBuB,WAAlB,CAAtB,EAAsDlG,IAAtD,CAAP;AACD,EAAA,OAFwB,CAAlB,CAAP;AAGD,EAAA,KAPI,EAQJ6D,IARI,CAQC;AAAA,EAAA,aAAM,CAACO,SAAD,EAAY,EAAZ,CAAN;AAAA,EAAA,KARD,CAAP;AASD,EAAA,GAjLqD;;;AAmLtD,EAAA;;;;;;;;;;;;AAYAiC,EAAAA,OA/LsD,iBA+L/CtF,MA/L+C,EA+LvC+D,EA/LuC,EA+LnC9E,IA/LmC,EA+L7B;AACvBA,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,QAAMsL,UAAU,KAAKD,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,EAA0BwL,KAA1B,CAAgC1G,EAAhC,CAAhB;AACA,EAAA,WAAO,KAAK4G,KAAL,CAAWJ,OAAX,EAAoBzH,IAApB,CAAyB,UAACc,MAAD;AAAA,EAAA,aAAY,CAACA,MAAD,EAAS,EAAEgH,KAAKL,OAAP,EAAT,CAAZ;AAAA,EAAA,KAAzB,CAAP;AACD,EAAA,GAnMqD;;AAoMtD,EAAA;;;;;;;;;;;;AAYA5D,EAAAA,UAhNsD,oBAgN5C3G,MAhN4C,EAgNpC6C,KAhNoC,EAgN7B5D,IAhN6B,EAgNvB;AAC7B4D,EAAAA,cAAUA,QAAQ,EAAlB;AACA5D,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA,QAAMoL,gBAAgB,KAAKC,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,CAAtB;;AAEA,EAAA,WAAOoL,cAAcW,IAAd,CAAmB,OAAnB,EAA4BlI,IAA5B,CAAiC,UAACmI,YAAD,EAAkB;AACxD,EAAA,UAAMvK,OAAOuK,aAAaE,GAAb,EAAb;AACA,EAAA,UAAI,CAACzK,IAAL,EAAW;AACT,EAAA,eAAO,CAAC,EAAD,EAAK,EAAEkK,KAAKP,aAAP,EAAL,CAAP;AACD,EAAA;AACD,EAAA,UAAMhG,UAAU,EAAhB;AACAhF,EAAAA,mBAAMkM,MAAN,CAAa7K,IAAb,EAAmB,UAACJ,KAAD,EAAQ0E,GAAR,EAAgB;AACjCX,EAAAA,gBAAQvE,IAAR,CAAaQ,KAAb;AACD,EAAA,OAFD;AAGA,EAAA,UAAMkL,SAAS,IAAIC,YAAJ,CAAU;AACvBC,EAAAA,eAAO;AACLC,EAAAA,gBADK,oBACK;AACR,EAAA,mBAAOtH,OAAP;AACD,EAAA;AAHI,EAAA;AADgB,EAAA,OAAV,CAAf;AAOA,EAAA,aAAO,CAACmH,OAAOnL,MAAP,CAAcwC,KAAd,EAAqB+I,GAArB,EAAD,EAA6B,EAAEhB,KAAKP,aAAP,EAA7B,CAAP;AACD,EAAA,KAjBM,CAAP;AAkBD,EAAA,GAxOqD;;;AA0OtD,EAAA;;;;;;;;;;;;;AAaA/B,EAAAA,MAvPsD,gBAuPhDtI,MAvPgD,EAuPxCmI,KAvPwC,EAuPjCtF,KAvPiC,EAuP1B5D,IAvP0B,EAuPpB;AAChC,EAAA,WAAO,KAAK0H,QAAL,CAAc3G,MAAd,EAAsB6C,KAAtB,EAA6B5D,IAA7B,EAAmC6D,IAAnC,CAAwC,UAACG,MAAD,EAAY;AACzDA,EAAAA,aAAO,CAAP,IAAYA,OAAO,CAAP,EAAU4I,MAAV,CAAiB,UAAC3D,GAAD,EAAMtE,MAAN;AAAA,EAAA,eAAiBsE,OAAO7I,aAAMgI,GAAN,CAAUzD,MAAV,EAAkBuE,KAAlB,KAA4B,CAAnC,CAAjB;AAAA,EAAA,OAAjB,EAAyE,CAAzE,CAAZ;AACA,EAAA,aAAOlF,MAAP;AACD,EAAA,KAHM,CAAP;AAID,EAAA,GA5PqD;;;AA8PtD,EAAA;;;;;;;;;;;;;AAaAuF,EAAAA,SA3QsD,mBA2Q7CxI,MA3Q6C,EA2QrC+D,EA3QqC,EA2QjC9D,KA3QiC,EA2Q1BhB,IA3Q0B,EA2QpB;AAAA,EAAA;;AAChCgB,EAAAA,cAAUA,QAAQ,EAAlB;AACAhB,EAAAA,aAASA,OAAO,EAAhB;;AAEA,EAAA,QAAMsL,UAAU,KAAKD,MAAL,CAAYtK,MAAZ,EAAoBf,IAApB,EAA0BwL,KAA1B,CAAgC1G,EAAhC,CAAhB;AACA,EAAA,WAAO,KAAK4G,KAAL,CAAWJ,OAAX,EACJzH,IADI,CACC,UAACgJ,UAAD,EAAgB;AACpB,EAAA,UAAI,CAACA,UAAL,EAAiB;AACf,EAAA,cAAM,IAAIzD,KAAJ,CAAU,WAAV,CAAN;AACD,EAAA;AACDhJ,EAAAA,mBAAM0M,SAAN,CAAgBD,UAAhB,EAA4B7L,KAA5B;AACA,EAAA,aAAOsK,QAAQG,GAAR,CAAYoB,UAAZ,CAAP;AACD,EAAA,KAPI,EAQJhJ,IARI,CAQC;AAAA,EAAA,aAAM,OAAK6H,KAAL,CAAWJ,OAAX,CAAN;AAAA,EAAA,KARD,EASJzH,IATI,CASC,UAACc,MAAD,EAAY;AAChB,EAAA,UAAI,CAACA,MAAL,EAAa;AACX,EAAA,cAAM,IAAIyE,KAAJ,CAAU,WAAV,CAAN;AACD,EAAA;AACD,EAAA,aAAO,CAACzE,MAAD,EAAS,EAAEgH,KAAKL,OAAP,EAAT,CAAP;AACD,EAAA,KAdI,CAAP;AAeD,EAAA,GA/RqD;;;AAiStD,EAAA;;;;;;;;;;;;;AAaA5B,EAAAA,YA9SsD,sBA8S1C3I,MA9S0C,EA8SlCC,KA9SkC,EA8S3B4C,KA9S2B,EA8SpB5D,IA9SoB,EA8Sd;AAAA,EAAA;;AACtCA,EAAAA,aAASA,OAAO,EAAhB;AACAgB,EAAAA,cAAUA,QAAQ,EAAlB;AACA4C,EAAAA,cAAUA,QAAQ,EAAlB;;AAEA,EAAA,WAAO,KAAK8D,QAAL,CAAc3G,MAAd,EAAsB6C,KAAtB,EAA6B5D,IAA7B,EAAmC6D,IAAnC,CAAwC,UAACE,OAAD,EAAa;AAAA,EAAA,oCACxCA,OADwC;AAAA,EAAA,UACnDqB,OADmD;;AAE1DA,EAAAA,cAAQzE,OAAR,CAAgB,UAACgE,MAAD;AAAA,EAAA,eAAYvE,aAAM0M,SAAN,CAAgBnI,MAAhB,EAAwB3D,KAAxB,CAAZ;AAAA,EAAA,OAAhB;AACA,EAAA,aAAO,OAAK4K,YAAL,CAAkB7K,MAAlB,EAA0BqE,OAA1B,EAAmCpF,IAAnC,CAAP;AACD,EAAA,KAJM,CAAP;AAKD,EAAA,GAxTqD;;;AA0TtD,EAAA;;;;;;;;;;;;AAYA4J,EAAAA,aAtUsD,uBAsUzC7I,MAtUyC,EAsUjCqE,OAtUiC,EAsUxBpF,IAtUwB,EAsUlB;AAClCA,EAAAA,aAASA,OAAO,EAAhB;AACA,EAAA,WAAO,KAAK4L,YAAL,CAAkB7K,MAAlB,EAA0BqE,OAA1B,EAAmCpF,IAAnC,CAAP;AACD,EAAA,GAzUqD;AA2UtDqL,EAAAA,QA3UsD,kBA2U9CtK,MA3U8C,EA2UtCf,IA3UsC,EA2UhC;AACpBA,EAAAA,WAAOA,QAAQ,EAAf;AACA,EAAA,WAAO,KAAK2K,EAAL,CAAQgB,GAAR,GAAcH,KAAd,CAAoBxL,KAAK+M,QAAL,IAAiBhM,OAAOgM,QAAxB,IAAoChM,OAAOiM,IAA/D,CAAP;AACD,EAAA,GA9UqD;AAgVtD3I,EAAAA,QAhVsD,kBAgV9CtD,MAhV8C,EAgVtCC,KAhVsC,EAgV/BhB,IAhV+B,EAgVzB;AAAA,EAAA;;AAC3B,EAAA,WAAOkK,WAAW,UAAC+C,OAAD,EAAUC,OAAV,EAAsB;AACtCjD,EAAAA,gBAAU,YAAM;AACdO,EAAAA,kBAAUnG,MAAV,CAAiBnC,IAAjB,SAA4BnB,MAA5B,EAAoCC,KAApC,EAA2ChB,IAA3C,EAAiD6D,IAAjD,CAAsDoJ,OAAtD,EAA+DC,OAA/D;AACD,EAAA,OAFD;AAGD,EAAA,KAJM,CAAP;AAKD,EAAA,GAtVqD;AAwVtDzI,EAAAA,YAxVsD,sBAwV1C1D,MAxV0C,EAwVlCC,KAxVkC,EAwV3BhB,IAxV2B,EAwVrB;AAAA,EAAA;;AAC/B,EAAA,WAAOkK,WAAW,UAAC+C,OAAD,EAAUC,OAAV,EAAsB;AACtCjD,EAAAA,gBAAU,YAAM;AACdO,EAAAA,kBAAU/F,UAAV,CAAqBvC,IAArB,SAAgCnB,MAAhC,EAAwCC,KAAxC,EAA+ChB,IAA/C,EAAqD6D,IAArD,CAA0DoJ,OAA1D,EAAmEC,OAAnE;AACD,EAAA,OAFD;AAGD,EAAA,KAJM,CAAP;AAKD,EAAA,GA9VqD;AAgWtDrI,EAAAA,SAhWsD,mBAgW7C9D,MAhW6C,EAgWrC+D,EAhWqC,EAgWjC9E,IAhWiC,EAgW3B;AAAA,EAAA;;AACzB,EAAA,WAAOkK,WAAW,UAAC+C,OAAD,EAAUC,OAAV,EAAsB;AACtCjD,EAAAA,gBAAU,YAAM;AACdO,EAAAA,kBAAU3F,OAAV,CAAkB3C,IAAlB,SAA6BnB,MAA7B,EAAqC+D,EAArC,EAAyC9E,IAAzC,EAA+C6D,IAA/C,CAAoDoJ,OAApD,EAA6DC,OAA7D;AACD,EAAA,OAFD;AAGD,EAAA,KAJM,CAAP;AAKD,EAAA,GAtWqD;AAwWtDlI,EAAAA,YAxWsD,sBAwW1CjE,MAxW0C,EAwWlC6C,KAxWkC,EAwW3B5D,IAxW2B,EAwWrB;AAAA,EAAA;;AAC/B,EAAA,WAAOkK,WAAW,UAAC+C,OAAD,EAAUC,OAAV,EAAsB;AACtCjD,EAAAA,gBAAU,YAAM;AACdO,EAAAA,kBAAUxF,UAAV,CAAqB9C,IAArB,UAAgCnB,MAAhC,EAAwC6C,KAAxC,EAA+C5D,IAA/C,EAAqD6D,IAArD,CAA0DoJ,OAA1D,EAAmEC,OAAnE;AACD,EAAA,OAFD;AAGD,EAAA,KAJM,CAAP;AAKD,EAAA,GA9WqD;AAgXtD5D,EAAAA,QAhXsD,kBAgX9CvI,MAhX8C,EAgXtC+D,EAhXsC,EAgXlC9D,KAhXkC,EAgX3BhB,IAhX2B,EAgXrB;AAAA,EAAA;;AAC/B,EAAA,WAAOkK,WAAW,UAAC+C,OAAD,EAAUC,OAAV,EAAsB;AACtCjD,EAAAA,gBAAU,YAAM;AACdO,EAAAA,kBAAUlB,MAAV,CAAiBpH,IAAjB,UAA4BnB,MAA5B,EAAoC+D,EAApC,EAAwC9D,KAAxC,EAA+ChB,IAA/C,EAAqD6D,IAArD,CAA0DoJ,OAA1D,EAAmEC,OAAnE;AACD,EAAA,OAFD;AAGD,EAAA,KAJM,CAAP;AAKD,EAAA,GAtXqD;AAwXtDzD,EAAAA,WAxXsD,qBAwX3C1I,MAxX2C,EAwXnCC,KAxXmC,EAwX5B4C,KAxX4B,EAwXrB5D,IAxXqB,EAwXf;AAAA,EAAA;;AACrC,EAAA,WAAOkK,WAAW,UAAC+C,OAAD,EAAUC,OAAV,EAAsB;AACtCjD,EAAAA,gBAAU,YAAM;AACdO,EAAAA,kBAAUf,SAAV,CAAoBvH,IAApB,UAA+BnB,MAA/B,EAAuCC,KAAvC,EAA8C4C,KAA9C,EAAqD5D,IAArD,EAA2D6D,IAA3D,CAAgEoJ,OAAhE,EAAyEC,OAAzE;AACD,EAAA,OAFD;AAGD,EAAA,KAJM,CAAP;AAKD,EAAA,GA9XqD;AAgYtDvD,EAAAA,YAhYsD,sBAgY1C5I,MAhY0C,EAgYlCqE,OAhYkC,EAgYzBpF,IAhYyB,EAgYnB;AAAA,EAAA;;AACjC,EAAA,WAAOkK,WAAW,UAAC+C,OAAD,EAAUC,OAAV,EAAsB;AACtCjD,EAAAA,gBAAU,YAAM;AACdO,EAAAA,kBAAUb,UAAV,CAAqBzH,IAArB,UAAgCnB,MAAhC,EAAwCqE,OAAxC,EAAiDpF,IAAjD,EAAuD6D,IAAvD,CAA4DoJ,OAA5D,EAAqEC,OAArE;AACD,EAAA,OAFD;AAGD,EAAA,KAJM,CAAP;AAKD,EAAA;AAtYqD,EAAA,CAAxD;;AAyYA,EAAA;;;;;;;;;;;;;;;AAeA,EAAO,IAAMC,UAAU,gBAAhB;;;;;;;"}